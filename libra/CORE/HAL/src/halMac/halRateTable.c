/*
 * Qualcomm Inc proprietary. All rights reserved.
 * halRateTables.c:  Contains All rete information and access functions.
 * Author:    Arul Vasantharaj
 * Date:      05/14/2008
 *
 * ---------------------------------------------------------------
 */

#include "halInternal.h"
#include "halDebug.h"
#include "halPhyApi.h"
#include "cfgApi.h"
#include "halUtils.h"
#include "halAdu.h"
#include "halStaTable.h" // Tx Ack Policy definitions
#include "halRegBckup.h"
#include "halRateAdaptApi.h"

//Libra Rate Table
static tHalRateTable halRateTable[MAX_LIBRA_RATE_NUM];

/* -------------------------------------------
 *  Response Rate Index Table (index 0 - 67)
 * -------------------------------------------
 */
static tANI_U16 rspRateIndexTable[MAX_LIBRA_RATE_NUM];

/* This is the default reference basic rate table which only contains PHY mandatory rates
 * This table is passed to halRate_updateRespRateTable() during initialization only
 */
tHalMacRate defRefBasicRateTable [RA_TOTAL_MODULATION][RA_TOTAL_CODERATE] ={
                /* 1/2                  2/3             3/4             5/6                 7/8  */
    /* BPSK */  {HALRATE_6,         HALRATE_INVALID, HALRATE_INVALID, HALRATE_INVALID, HALRATE_INVALID },
    /* QPSK */  {HALRATE_12,        HALRATE_INVALID, HALRATE_INVALID, HALRATE_INVALID, HALRATE_INVALID },
    /* 16QAM */ {HALRATE_24,        HALRATE_INVALID, HALRATE_INVALID, HALRATE_INVALID, HALRATE_INVALID },
    /* 64QAM */ {HALRATE_INVALID,   HALRATE_INVALID, HALRATE_INVALID, HALRATE_INVALID, HALRATE_INVALID }
};

/* This is the reference basic rate table used during runtime. It should be filled in everytime when
 * add/delete a BSS. The basic rates which the BSS supports should be updated to this table. HAL would use
 * this table to determine all the response rates.
 */
tHalMacRate currentRefBasicRateTable [RA_TOTAL_MODULATION][RA_TOTAL_CODERATE] ={
                /* 1/2      2/3    3/4     5/6 7/8  */
    /* BPSK */  {HALRATE_INVALID, HALRATE_INVALID, HALRATE_INVALID, HALRATE_INVALID, HALRATE_INVALID },
    /* QPSK */  {HALRATE_INVALID, HALRATE_INVALID, HALRATE_INVALID, HALRATE_INVALID, HALRATE_INVALID },//{0, 0, 0, 0, 0 },
    /* 16QAM */ {HALRATE_INVALID, HALRATE_INVALID, HALRATE_INVALID, HALRATE_INVALID, HALRATE_INVALID },//{0, 0, 0, 0, 0 },
    /* 64QAM */ {HALRATE_INVALID, HALRATE_INVALID, HALRATE_INVALID, HALRATE_INVALID, HALRATE_INVALID } //{0, 0, 0, 0, 0 }
};

tHalMacRate currentRefRespRateTable [RA_TOTAL_MODULATION][RA_TOTAL_CODERATE] ={
                /* 1/2      2/3    3/4     5/6 7/8  */
    /* BPSK */  {HALRATE_6,         HALRATE_INVALID, HALRATE_INVALID, HALRATE_INVALID, HALRATE_INVALID },
    /* QPSK */  {HALRATE_12,        HALRATE_INVALID, HALRATE_INVALID, HALRATE_INVALID, HALRATE_INVALID },
    /* 16QAM */ {HALRATE_24,        HALRATE_INVALID, HALRATE_INVALID, HALRATE_INVALID, HALRATE_INVALID },
    /* 64QAM */ {HALRATE_INVALID,   HALRATE_INVALID, HALRATE_INVALID, HALRATE_INVALID, HALRATE_INVALID }
};


/* -------------------------------------------
 *  TPE Rate Table for 0-67 entries
 * -------------------------------------------*/
static tTpeSramRateTable tpeSramRateTable[MAX_LIBRA_RATE_NUM] = {

    /*---- RateIndex Index 00, 802.11b 1Mbps Long preamble  ---- */
    {
        PKTTYPE(PKT_TYPE_11b) | PSDURATE(HAL_PSDU_RATE_11B_LONG_1_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PR_LONG) |
            SHORTGUARD(SG_DISABLED) | CTRLRATEIDX(TPE_RT_IDX_11B_LONG_1_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11B_LONG_1_MBPS) | AMPDU(0) |
            NDBPS4TRATE(HAL_PSDU_RATE_11B_4T_1_MBPS) | NDLTFS(NDLTF_ONE) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_1_MBPS_OFFSET) |
            STBC(STBC_INV)
    },

  /*---- RateIndex Index 01, 802.11b 2Mbps Long preamble  ---- */
    {
        PKTTYPE(PKT_TYPE_11b) | PSDURATE(HAL_PSDU_RATE_11B_LONG_2_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PR_LONG) |
            SHORTGUARD(SG_DISABLED) | CTRLRATEIDX(TPE_RT_IDX_11B_LONG_2_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11B_LONG_2_MBPS) | AMPDU(0) |
            NDBPS4TRATE(HAL_PSDU_RATE_11B_4T_2_MBPS) | NDLTFS(NDLTF_ONE) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_2_MBPS_OFFSET) |
            STBC(STBC_INV)
    },

  /*---- RateIndex Index 02, 802.11b 5.5Mbps Long preamble  ---- */
    {
        PKTTYPE(PKT_TYPE_11b) | PSDURATE(HAL_PSDU_RATE_11B_LONG_5_5_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PR_LONG) |
            SHORTGUARD(SG_DISABLED) | CTRLRATEIDX(TPE_RT_IDX_11B_LONG_5_5_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11B_LONG_5_5_MBPS) | AMPDU(0) |
            NDBPS4TRATE(HAL_PSDU_RATE_11B_4T_5_5_MBPS) | NDLTFS(NDLTF_ONE) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_5_5_MBPS_OFFSET) |
            STBC(STBC_INV)
    },

  /*---- RateIndex Index 03, 802.11b 11Mbps Long preamble  ---- */
    {
        PKTTYPE(PKT_TYPE_11b) | PSDURATE(HAL_PSDU_RATE_11B_LONG_11_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PR_LONG) |
            SHORTGUARD(SG_DISABLED) | CTRLRATEIDX(TPE_RT_IDX_11B_LONG_11_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11B_LONG_11_MBPS) | AMPDU(0) |
            NDBPS4TRATE(HAL_PSDU_RATE_11B_4T_11_MBPS) | NDLTFS(NDLTF_ONE) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_11_MBPS_OFFSET) |
            STBC(STBC_INV)
    },

  /*---- RateIndex Index 04, 802.11b 1Mbps Long preamble  ---- */
    {
        PKTTYPE(PKT_TYPE_11b) | PSDURATE(HAL_PSDU_RATE_11B_LONG_1_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PR_LONG) |
            SHORTGUARD(SG_DISABLED) | CTRLRATEIDX(TPE_RT_IDX_11B_LONG_1_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11B_LONG_1_MBPS) | AMPDU(0) |
            NDBPS4TRATE(HAL_PSDU_RATE_11B_4T_1_MBPS) | NDLTFS(NDLTF_ONE) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_1_MBPS_OFFSET) |
            STBC(STBC_INV)
    },

  /*---- RateIndex Index 05, 802.11b 2Mbps Short preamble  ---- */
    {
        PKTTYPE(PKT_TYPE_11b) | PSDURATE(HAL_PSDU_RATE_11B_SHORT_2_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PR_SHORT) |
            SHORTGUARD(SG_DISABLED) | CTRLRATEIDX(TPE_RT_IDX_11B_SHORT_2_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11B_SHORT_2_MBPS) | AMPDU(0) |
            NDBPS4TRATE(HAL_PSDU_RATE_11B_4T_2_MBPS) | NDLTFS(NDLTF_ONE) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_SHORT_2_MBPS_OFFSET) |
            STBC(STBC_INV)
    },

  /*---- RateIndex Index 06, 802.11b 5.5Mbps Short preamble  ---- */
    {
        PKTTYPE(PKT_TYPE_11b) | PSDURATE(HAL_PSDU_RATE_11B_SHORT_5_5_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PR_SHORT) |
            SHORTGUARD(SG_DISABLED) | CTRLRATEIDX(TPE_RT_IDX_11B_SHORT_5_5_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11B_SHORT_5_5_MBPS) | AMPDU(0) |
            NDBPS4TRATE(HAL_PSDU_RATE_11B_4T_5_5_MBPS) | NDLTFS(NDLTF_ONE) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_SHORT_5_5_MBPS_OFFSET) |
            STBC(STBC_INV)
    },

  /*---- RateIndex Index 07, 802.11b 11Mbps Short preamble  ---- */
    {
        PKTTYPE(PKT_TYPE_11b) | PSDURATE(HAL_PSDU_RATE_11B_SHORT_11_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PR_SHORT) |
            SHORTGUARD(SG_DISABLED) | CTRLRATEIDX(TPE_RT_IDX_11B_SHORT_11_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11B_SHORT_11_MBPS) | AMPDU(0) |
            NDBPS4TRATE(HAL_PSDU_RATE_11B_4T_11_MBPS) | NDLTFS(NDLTF_ONE) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_SHORT_11_MBPS_OFFSET) |
            STBC(STBC_INV)
    },

  /*---- RateIndex Index 08 11, 11a/g rates  20Mhz  6Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11a) | PSDURATE(HAL_PSDU_RATE_11A_6_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_DISABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_6_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_6_MBPS) | AMPDU(0) |
            NDBPS4TRATE(HAL_PSDU_RATE_11A_4T_6_MBPS) | NDLTFS(NDLTF_ONE) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_5_5_MBPS_OFFSET) |
            STBC(STBC_INV)
    },

  /*---- RateIndex Index 09 15, 11a/g rates  20Mhz  9Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11a) | PSDURATE(HAL_PSDU_RATE_11A_9_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_DISABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_6_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_6_MBPS) | AMPDU(0) |
            NDBPS4TRATE(HAL_PSDU_RATE_11A_4T_9_MBPS) | NDLTFS(NDLTF_ONE) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_5_5_MBPS_OFFSET) |
            STBC(STBC_INV)
    },

   /*---- RateIndex Index 10 10, 11a/g rates  20Mhz  12Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11a) | PSDURATE(HAL_PSDU_RATE_11A_12_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_DISABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_12_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_12_MBPS) | AMPDU(0) |
            NDBPS4TRATE(HAL_PSDU_RATE_11A_4T_12_MBPS) | NDLTFS(NDLTF_ONE) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_11_MBPS_OFFSET) |
            STBC(STBC_INV)
    },

  /*---- RateIndex Index 11 14, 11a/g rates  20Mhz  18Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11a) | PSDURATE(HAL_PSDU_RATE_11A_18_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_DISABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_12_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_12_MBPS) | AMPDU(0) |
            NDBPS4TRATE(HAL_PSDU_RATE_11A_4T_18_MBPS) | NDLTFS(NDLTF_ONE) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_11_MBPS_OFFSET) |
            STBC(STBC_INV)
    },

  /*---- RateIndex Index 12 9, 11a/g rates  20Mhz  24Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11a) | PSDURATE(HAL_PSDU_RATE_11A_24_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_DISABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_24_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_24_MBPS) | AMPDU(0) |
            NDBPS4TRATE(HAL_PSDU_RATE_11A_4T_24_MBPS) | NDLTFS(NDLTF_ONE) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_11_MBPS_OFFSET) |
            STBC(STBC_INV)
    },

  /*---- RateIndex Index 13 13, 11a/g rates  20Mhz  36Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11a) | PSDURATE(HAL_PSDU_RATE_11A_36_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_DISABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_24_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_24_MBPS) | AMPDU(0) |
            NDBPS4TRATE(HAL_PSDU_RATE_11A_4T_36_MBPS) | NDLTFS(NDLTF_ONE) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_11_MBPS_OFFSET) |
            STBC(STBC_INV)
    },

  /*---- RateIndex Index 14 8, 11a/g rates  20Mhz  48Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11a) | PSDURATE(HAL_PSDU_RATE_11A_48_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_DISABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_24_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_24_MBPS) | AMPDU(0) |
            NDBPS4TRATE(HAL_PSDU_RATE_11A_4T_48_MBPS) | NDLTFS(NDLTF_ONE) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_11_MBPS_OFFSET) |
            STBC(STBC_INV)
    },

  /*---- RateIndex Index 15 12, 11a/g rates  20Mhz  54Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11a) | PSDURATE(HAL_PSDU_RATE_11A_54_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_DISABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_24_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_24_MBPS) | AMPDU(0) |
            NDBPS4TRATE(HAL_PSDU_RATE_11A_4T_54_MBPS) | NDLTFS(NDLTF_ONE) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_11_MBPS_OFFSET) |
            STBC(STBC_INV)
    },

   /*---- RateIndex Index 16 96, MCS Index #0-15 (20MHz) Mixed Mode 6.5Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11N_MIXEDMODE) | PSDURATE(HAL_PSDU_RATE_MCS_1NSS_MM_6_5_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_DISABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_6_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_6_MBPS) | AMPDU(1) |
            NDBPS4TRATE(HAL_PSDU_RATE_20MHZ_MCS_IND_0_NDBPS) | NDLTFS(NDLTF_ONE) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_5_5_MBPS_OFFSET) |
            STBC(STBC_INV)
    },

  /*---- RateIndex Index 17 98, MCS Index #0-15 (20MHz) Mixed Mode 13Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11N_MIXEDMODE) | PSDURATE(HAL_PSDU_RATE_MCS_1NSS_MM_13_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_DISABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_12_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_12_MBPS) | AMPDU(1) |
            NDBPS4TRATE(HAL_PSDU_RATE_20MHZ_MCS_IND_1_NDBPS) | NDLTFS(NDLTF_ONE) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_11_MBPS_OFFSET) |
            STBC(STBC_INV)
    },

  /*---- RateIndex Index 18 100, MCS Index #0-15 (20MHz) Mixed Mode 19.5Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11N_MIXEDMODE) | PSDURATE(HAL_PSDU_RATE_MCS_1NSS_MM_19_5_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_DISABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_12_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_12_MBPS) | AMPDU(1) |
            NDBPS4TRATE(HAL_PSDU_RATE_20MHZ_MCS_IND_2_NDBPS) | NDLTFS(NDLTF_ONE) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_11_MBPS_OFFSET) |
            STBC(STBC_INV)
    },

  /*---- RateIndex Index 19 102, MCS Index #0-15 (20MHz) Mixed Mode 26Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11N_MIXEDMODE) | PSDURATE(HAL_PSDU_RATE_MCS_1NSS_MM_26_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_DISABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_24_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_24_MBPS) | AMPDU(1) |
            NDBPS4TRATE(HAL_PSDU_RATE_20MHZ_MCS_IND_3_NDBPS) | NDLTFS(NDLTF_ONE) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_11_MBPS_OFFSET) |
            STBC(STBC_INV)
    },

  /*---- RateIndex Index 20 103, MCS Index #0-15 (20MHz) Mixed Mode 39Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11N_MIXEDMODE) | PSDURATE(HAL_PSDU_RATE_MCS_1NSS_MM_39_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_DISABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_24_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_24_MBPS) | AMPDU(1) |
            NDBPS4TRATE(HAL_PSDU_RATE_20MHZ_MCS_IND_4_NDBPS) | NDLTFS(NDLTF_ONE) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_11_MBPS_OFFSET) |
            STBC(STBC_INV)
    },

  /*---- RateIndex Index 21 106, MCS Index #0-15 (20MHz) Mixed Mode 52Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11N_MIXEDMODE) | PSDURATE(HAL_PSDU_RATE_MCS_1NSS_MM_52_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_DISABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_24_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_24_MBPS) | AMPDU(1) |
            NDBPS4TRATE(HAL_PSDU_RATE_20MHZ_MCS_IND_5_NDBPS) | NDLTFS(NDLTF_ONE) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_11_MBPS_OFFSET) |
            STBC(STBC_INV)
    },

  /*---- RateIndex Index 22 108, MCS Index #0-15 (20MHz) Mixed Mode 58.5Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11N_MIXEDMODE) | PSDURATE(HAL_PSDU_RATE_MCS_1NSS_MM_58_5_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_DISABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_24_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_24_MBPS) | AMPDU(1) |
            NDBPS4TRATE(HAL_PSDU_RATE_20MHZ_MCS_IND_6_NDBPS) | NDLTFS(NDLTF_ONE) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_11_MBPS_OFFSET) |
            STBC(STBC_INV)
    },

  /*---- RateIndex Index 23 110, MCS Index #0-15 (20MHz) Mixed Mode 65Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11N_MIXEDMODE) | PSDURATE(HAL_PSDU_RATE_MCS_1NSS_MM_65_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_DISABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_24_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_24_MBPS) | AMPDU(1) |
            NDBPS4TRATE(HAL_PSDU_RATE_20MHZ_MCS_IND_7_NDBPS) | NDLTFS(NDLTF_ONE) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_11_MBPS_OFFSET) |
            STBC(STBC_INV)
    },

  /*---- RateIndex Index 24 97, MCS Index #0-15 (20MHz) Mixed Mode 7.2Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11N_MIXEDMODE) | PSDURATE(HAL_PSDU_RATE_MCS_1NSS_MM_SG_7_2_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_ENABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_6_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_6_MBPS) | AMPDU(1) |
            NDBPS4TRATE(HAL_PSDU_RATE_20MHZ_MCS_IND_0_NDBPS) | NDLTFS(NDLTF_ONE) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_5_5_MBPS_OFFSET) |
            STBC(STBC_INV)
    },

  /*---- RateIndex Index 25 99, MCS Index #0-15 (20MHz) Mixed Mode 14.4Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11N_MIXEDMODE) | PSDURATE(HAL_PSDU_RATE_MCS_1NSS_MM_SG_14_4_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_ENABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_12_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_12_MBPS) | AMPDU(1) |
            NDBPS4TRATE(HAL_PSDU_RATE_20MHZ_MCS_IND_1_NDBPS) | NDLTFS(NDLTF_ONE) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_11_MBPS_OFFSET) |
            STBC(STBC_INV)
    },

  /*---- RateIndex Index 26 101, MCS Index #0-15 (20MHz) Mixed Mode 21.7Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11N_MIXEDMODE) | PSDURATE(HAL_PSDU_RATE_MCS_1NSS_MM_SG_21_7_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_ENABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_12_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_12_MBPS) | AMPDU(1) |
            NDBPS4TRATE(HAL_PSDU_RATE_20MHZ_MCS_IND_2_NDBPS) | NDLTFS(NDLTF_ONE) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_11_MBPS_OFFSET) |
            STBC(STBC_INV)
    },

  /*---- RateIndex Index 27 104, MCS Index #0-15 (20MHz) Mixed Mode 28.9Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11N_MIXEDMODE) | PSDURATE(HAL_PSDU_RATE_MCS_1NSS_MM_SG_28_9_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_ENABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_24_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_24_MBPS) | AMPDU(1) |
            NDBPS4TRATE(HAL_PSDU_RATE_20MHZ_MCS_IND_3_NDBPS) | NDLTFS(NDLTF_ONE) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_11_MBPS_OFFSET) |
            STBC(STBC_INV)
    },

  /*---- RateIndex Index 28 105, MCS Index #0-15 (20MHz) Mixed Mode 43.3Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11N_MIXEDMODE) | PSDURATE(HAL_PSDU_RATE_MCS_1NSS_MM_SG_43_3_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_ENABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_24_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_24_MBPS) | AMPDU(1) |
            NDBPS4TRATE(HAL_PSDU_RATE_20MHZ_MCS_IND_4_NDBPS) | NDLTFS(NDLTF_ONE) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_11_MBPS_OFFSET) |
            STBC(STBC_INV)
    },

  /*---- RateIndex Index 29 107, MCS Index #0-15 (20MHz) Mixed Mode 57.8Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11N_MIXEDMODE) | PSDURATE(HAL_PSDU_RATE_MCS_1NSS_MM_SG_57_8_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_ENABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_24_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_24_MBPS) | AMPDU(1) |
            NDBPS4TRATE(HAL_PSDU_RATE_20MHZ_MCS_IND_5_NDBPS) | NDLTFS(NDLTF_ONE) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_11_MBPS_OFFSET) |
            STBC(STBC_INV)
    },

  /*---- RateIndex Index 30 109, MCS Index #0-15 (20MHz) Mixed Mode 65Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11N_MIXEDMODE) | PSDURATE(HAL_PSDU_RATE_MCS_1NSS_MM_SG_65_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_ENABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_24_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_24_MBPS) | AMPDU(1) |
            NDBPS4TRATE(HAL_PSDU_RATE_20MHZ_MCS_IND_6_NDBPS) | NDLTFS(NDLTF_ONE) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_11_MBPS_OFFSET) |
            STBC(STBC_INV)
    },

  /*---- RateIndex Index 31 111, MCS Index #0-15 (20MHz) Mixed Mode 72.2Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11N_MIXEDMODE) | PSDURATE(HAL_PSDU_RATE_MCS_1NSS_MM_SG_72_2_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_ENABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_24_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_24_MBPS) | AMPDU(1) |
            NDBPS4TRATE(HAL_PSDU_RATE_20MHZ_MCS_IND_7_NDBPS) | NDLTFS(NDLTF_ONE) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_11_MBPS_OFFSET) |
            STBC(STBC_INV)
    },

  /*---- RateIndex Index 32 396, SLR 0.25Mbps Long preamble  ---- */
    {
        PKTTYPE(PKT_TYPE_11b) | PSDURATE(HAL_PSDU_RATE_SLR_0_25_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(SLR) |
            SHORTGUARD(SG_DISABLED) | CTRLRATEIDX(TPE_RT_IDX_SLR_0_25_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_SLR_0_25_MBPS) | AMPDU(0) |
            NDBPS4TRATE(HAL_PSDU_RATE_SLR_4T_0_25_MBPS) | NDLTFS(NDLTF_ONE) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_1_MBPS_OFFSET) |
            STBC(STBC_INV)
    },

  /*---- RateIndex Index 33 397, SLR 0.5Mbps Long preamble  ---- */
    {
        PKTTYPE(PKT_TYPE_11b) | PSDURATE(HAL_PSDU_RATE_SLR_0_5_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(SLR) |
            SHORTGUARD(SG_DISABLED) | CTRLRATEIDX(TPE_RT_IDX_SLR_0_5_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_SLR_0_5_MBPS) | AMPDU(0) |
            NDBPS4TRATE(HAL_PSDU_RATE_SLR_4T_0_5_MBPS) | NDLTFS(NDLTF_ONE) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_1_MBPS_OFFSET) |
            STBC(STBC_INV)
    },

  /*---- RateIndex Index 34 32, MCS Index #0-15 (20MHz) Greenfield Mode 6.5Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11N_GREENFIELD) | PSDURATE(HAL_PSDU_RATE_MCS_1NSS_GF_6_5_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_DISABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_6_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_6_MBPS) | AMPDU(1) |
            NDBPS4TRATE(HAL_PSDU_RATE_20MHZ_MCS_IND_0_NDBPS) | NDLTFS(NDLTF_ONE) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_5_5_MBPS_OFFSET) |
            STBC(STBC_INV)
    },

  /*---- RateIndex Index 35 34, MCS Index #0-15 (20MHz) Greenfield Mode 13Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11N_GREENFIELD) | PSDURATE(HAL_PSDU_RATE_MCS_1NSS_GF_13_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_DISABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_12_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_12_MBPS) | AMPDU(1) |
            NDBPS4TRATE(HAL_PSDU_RATE_20MHZ_MCS_IND_1_NDBPS) | NDLTFS(NDLTF_ONE) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_11_MBPS_OFFSET) |
            STBC(STBC_INV)
    },

  /*---- RateIndex Index 36 36, MCS Index #0-15 (20MHz) Greenfield Mode 19.5Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11N_GREENFIELD) | PSDURATE(HAL_PSDU_RATE_MCS_1NSS_GF_19_5_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_DISABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_12_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_12_MBPS) | AMPDU(1) |
            NDBPS4TRATE(HAL_PSDU_RATE_20MHZ_MCS_IND_2_NDBPS) | NDLTFS(NDLTF_ONE) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_11_MBPS_OFFSET) |
            STBC(STBC_INV)
    },

  /*---- RateIndex Index 37 38, MCS Index #0-15 (20MHz) Greenfield Mode 26Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11N_GREENFIELD) | PSDURATE(HAL_PSDU_RATE_MCS_1NSS_GF_26_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_DISABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_24_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_24_MBPS) | AMPDU(1) |
            NDBPS4TRATE(HAL_PSDU_RATE_20MHZ_MCS_IND_3_NDBPS) | NDLTFS(NDLTF_ONE) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_11_MBPS_OFFSET) |
            STBC(STBC_INV)
    },

  /*---- RateIndex Index 38 38 40, MCS Index #0-15 (20MHz) Greenfield Mode 39Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11N_GREENFIELD) | PSDURATE(HAL_PSDU_RATE_MCS_1NSS_GF_39_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_DISABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_24_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_24_MBPS) | AMPDU(1) |
            NDBPS4TRATE(HAL_PSDU_RATE_20MHZ_MCS_IND_4_NDBPS) | NDLTFS(NDLTF_ONE) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_11_MBPS_OFFSET) |
            STBC(STBC_INV)
    },

  /*---- RateIndex Index 39 42, MCS Index #0-15 (20MHz) Greenfield Mode 52Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11N_GREENFIELD) | PSDURATE(HAL_PSDU_RATE_MCS_1NSS_GF_52_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_DISABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_24_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_24_MBPS) | AMPDU(1) |
            NDBPS4TRATE(HAL_PSDU_RATE_20MHZ_MCS_IND_5_NDBPS) | NDLTFS(NDLTF_ONE) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_11_MBPS_OFFSET) |
            STBC(STBC_INV)
    },

  /*---- RateIndex Index 40 44, MCS Index #0-15 (20MHz) Greenfield Mode 58.5Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11N_GREENFIELD) | PSDURATE(HAL_PSDU_RATE_MCS_1NSS_GF_58_5_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_DISABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_24_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_24_MBPS) | AMPDU(1) |
            NDBPS4TRATE(HAL_PSDU_RATE_20MHZ_MCS_IND_6_NDBPS) | NDLTFS(NDLTF_ONE) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_11_MBPS_OFFSET) |
            STBC(STBC_INV)
    },

  /*---- RateIndex Index 41 46, MCS Index #0-15 (20MHz) Greenfield Mode 65Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11N_GREENFIELD) | PSDURATE(HAL_PSDU_RATE_MCS_1NSS_GF_65_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_DISABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_24_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_24_MBPS) | AMPDU(1) |
            NDBPS4TRATE(HAL_PSDU_RATE_20MHZ_MCS_IND_7_NDBPS) | NDLTFS(NDLTF_ONE) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_11_MBPS_OFFSET) |
            STBC(STBC_INV)
    },

  /*---- RateIndex Index 42 356, Qualcomm Proprietary Rates 20MHz Greenfield Mode 68.25Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11N_GREENFIELD) | PSDURATE(HAL_PSDU_RATE_ANI_GF_68_25_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_DISABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_24_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_24_MBPS) | AMPDU(1) |
            NDBPS4TRATE(HAL_PSDU_RATE_ANI_4T_68_25_MBPS) | NDLTFS(NDLTF_FOUR) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_5_5_MBPS_OFFSET) |
            STBC(STBC_INV)
    },

  /*---- RateIndex Index 43 292, MCS Index #0-15 STBC Rate (20MHz) Greenfield Mode 6.5Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11N_GREENFIELD) | PSDURATE(HAL_PSDU_RATE_MCS_1NSS_STBC_GF_6_5_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_DISABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_6_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_6_MBPS) | AMPDU(1) |
            NDBPS4TRATE(HAL_PSDU_RATE_20MHZ_MCS_IND_0_NDBPS) | NDLTFS(NDLTF_TWO) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_5_5_MBPS_OFFSET) |
            STBC(STBC_VALID)
    },

  /*---- RateIndex Index 44 294, MCS Index #0-15 STBC Rate (20MHz) Greenfield Mode 13Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11N_GREENFIELD) | PSDURATE(HAL_PSDU_RATE_MCS_1NSS_STBC_GF_13_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_DISABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_12_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_12_MBPS) | AMPDU(1) |
            NDBPS4TRATE(HAL_PSDU_RATE_20MHZ_MCS_IND_1_NDBPS) | NDLTFS(NDLTF_TWO) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_11_MBPS_OFFSET) |
            STBC(STBC_VALID)
    },

  /*---- RateIndex Index 45 296, MCS Index #0-15 STBC Rate (20MHz) Greenfield Mode 19.5Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11N_GREENFIELD) | PSDURATE(HAL_PSDU_RATE_MCS_1NSS_STBC_GF_19_5_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_DISABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_12_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_12_MBPS) | AMPDU(1) |
            NDBPS4TRATE(HAL_PSDU_RATE_20MHZ_MCS_IND_2_NDBPS) | NDLTFS(NDLTF_TWO) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_11_MBPS_OFFSET) |
            STBC(STBC_VALID)
    },

  /*---- RateIndex Index 46 298, MCS Index #0-15 STBC Rate (20MHz) Greenfield Mode 26Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11N_GREENFIELD) | PSDURATE(HAL_PSDU_RATE_MCS_1NSS_STBC_GF_26_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_DISABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_24_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_24_MBPS) | AMPDU(1) |
            NDBPS4TRATE(HAL_PSDU_RATE_20MHZ_MCS_IND_3_NDBPS) | NDLTFS(NDLTF_TWO) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_11_MBPS_OFFSET) |
            STBC(STBC_VALID)
    },

  /*---- RateIndex Index 47 300, MCS Index #0-15 STBC Rate (20MHz) Greenfield Mode 39Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11N_GREENFIELD) | PSDURATE(HAL_PSDU_RATE_MCS_1NSS_STBC_GF_39_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_DISABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_24_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_24_MBPS) | AMPDU(1) |
            NDBPS4TRATE(HAL_PSDU_RATE_20MHZ_MCS_IND_4_NDBPS) | NDLTFS(NDLTF_TWO) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_11_MBPS_OFFSET) |
            STBC(STBC_VALID)
    },

  /*---- RateIndex Index 48 302, MCS Index #0-15 STBC Rate (20MHz) Greenfield Mode 52Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11N_GREENFIELD) | PSDURATE(HAL_PSDU_RATE_MCS_1NSS_STBC_GF_52_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_DISABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_24_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_24_MBPS) | AMPDU(1) |
            NDBPS4TRATE(HAL_PSDU_RATE_20MHZ_MCS_IND_5_NDBPS) | NDLTFS(NDLTF_TWO) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_11_MBPS_OFFSET) |
            STBC(STBC_VALID)
    },

  /*---- RateIndex Index 49 304, MCS Index #0-15 STBC Rate (20MHz) Greenfield Mode 58.5Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11N_GREENFIELD) | PSDURATE(HAL_PSDU_RATE_MCS_1NSS_STBC_GF_58_5_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_DISABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_24_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_24_MBPS) | AMPDU(1) |
            NDBPS4TRATE(HAL_PSDU_RATE_20MHZ_MCS_IND_6_NDBPS) | NDLTFS(NDLTF_TWO) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_11_MBPS_OFFSET) |
            STBC(STBC_VALID)
    },

  /*---- RateIndex Index 50 306, MCS Index #0-15 STBC Rate (20MHz) Greenfield Mode 65Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11N_GREENFIELD) | PSDURATE(HAL_PSDU_RATE_MCS_1NSS_STBC_GF_65_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_DISABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_24_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_24_MBPS) | AMPDU(1) |
            NDBPS4TRATE(HAL_PSDU_RATE_20MHZ_MCS_IND_7_NDBPS) | NDLTFS(NDLTF_TWO) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_11_MBPS_OFFSET) |
            STBC(STBC_VALID)
    },

  /*---- RateIndex Index 51 308, MCS Index #0-15 STBC Rate (20MHz) Mixed Mode 6.5Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11N_MIXEDMODE) | PSDURATE(HAL_PSDU_RATE_MCS_1NSS_STBC_MM_6_5_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_DISABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_6_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_6_MBPS) | AMPDU(1) |
            NDBPS4TRATE(HAL_PSDU_RATE_20MHZ_MCS_IND_0_NDBPS) | NDLTFS(NDLTF_TWO) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_5_5_MBPS_OFFSET) |
            STBC(STBC_VALID)
    },

  /*---- RateIndex Index 52 309, MCS Index #0-15 STBC Rate (20MHz) Mixed Mode 7.2Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11N_MIXEDMODE) | PSDURATE(HAL_PSDU_RATE_MCS_1NSS_STBC_MM_SG_7_2_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_ENABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_6_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_6_MBPS) | AMPDU(1) |
            NDBPS4TRATE(HAL_PSDU_RATE_20MHZ_MCS_IND_0_NDBPS) | NDLTFS(NDLTF_TWO) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_5_5_MBPS_OFFSET) |
            STBC(STBC_VALID)
    },

  /*---- RateIndex Index 53 310, MCS Index #0-15 STBC Rate (20MHz) Mixed Mode 13Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11N_MIXEDMODE) | PSDURATE(HAL_PSDU_RATE_MCS_1NSS_STBC_MM_13_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_DISABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_12_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_12_MBPS) | AMPDU(1) |
            NDBPS4TRATE(HAL_PSDU_RATE_20MHZ_MCS_IND_1_NDBPS) | NDLTFS(NDLTF_TWO) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_11_MBPS_OFFSET) |
            STBC(STBC_VALID)
    },

  /*---- RateIndex Index 54 311, MCS Index #0-15 STBC Rate (20MHz) Mixed Mode 14.4Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11N_MIXEDMODE) | PSDURATE(HAL_PSDU_RATE_MCS_1NSS_STBC_MM_SG_14_4_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_ENABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_12_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_12_MBPS) | AMPDU(1) |
            NDBPS4TRATE(HAL_PSDU_RATE_20MHZ_MCS_IND_1_NDBPS) | NDLTFS(NDLTF_TWO) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_11_MBPS_OFFSET) |
            STBC(STBC_VALID)
    },

  /*---- RateIndex Index 55 312, MCS Index #0-15 STBC Rate (20MHz) Mixed Mode 19.5Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11N_MIXEDMODE) | PSDURATE(HAL_PSDU_RATE_MCS_1NSS_STBC_MM_19_5_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_DISABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_12_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_12_MBPS) | AMPDU(1) |
            NDBPS4TRATE(HAL_PSDU_RATE_20MHZ_MCS_IND_2_NDBPS) | NDLTFS(NDLTF_TWO) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_11_MBPS_OFFSET) |
            STBC(STBC_VALID)
    },

  /*---- RateIndex Index 56 313, MCS Index #0-15 STBC Rate (20MHz) Mixed Mode 21.7Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11N_MIXEDMODE) | PSDURATE(HAL_PSDU_RATE_MCS_1NSS_STBC_MM_SG_21_7_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_ENABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_12_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_12_MBPS) | AMPDU(1) |
            NDBPS4TRATE(HAL_PSDU_RATE_20MHZ_MCS_IND_2_NDBPS) | NDLTFS(NDLTF_TWO) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_11_MBPS_OFFSET) |
            STBC(STBC_VALID)
    },

  /*---- RateIndex Index 57 314, MCS Index #0-15 STBC Rate (20MHz) Mixed Mode 26Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11N_MIXEDMODE) | PSDURATE(HAL_PSDU_RATE_MCS_1NSS_STBC_MM_26_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_DISABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_24_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_24_MBPS) | AMPDU(1) |
            NDBPS4TRATE(HAL_PSDU_RATE_20MHZ_MCS_IND_3_NDBPS) | NDLTFS(NDLTF_TWO) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_11_MBPS_OFFSET) |
            STBC(STBC_VALID)
    },

  /*---- RateIndex Index 58 315, MCS Index #0-15 STBC Rate (20MHz) Mixed Mode 28.9Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11N_MIXEDMODE) | PSDURATE(HAL_PSDU_RATE_MCS_1NSS_STBC_MM_SG_28_9_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_ENABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_24_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_24_MBPS) | AMPDU(1) |
            NDBPS4TRATE(HAL_PSDU_RATE_20MHZ_MCS_IND_3_NDBPS) | NDLTFS(NDLTF_TWO) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_11_MBPS_OFFSET) |
            STBC(STBC_VALID)
    },

  /*---- RateIndex Index 59 316, MCS Index #0-15 STBC Rate (20MHz) Mixed Mode 39Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11N_MIXEDMODE) | PSDURATE(HAL_PSDU_RATE_MCS_1NSS_STBC_MM_39_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_DISABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_24_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_24_MBPS) | AMPDU(1) |
            NDBPS4TRATE(HAL_PSDU_RATE_20MHZ_MCS_IND_4_NDBPS) | NDLTFS(NDLTF_TWO) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_11_MBPS_OFFSET) |
            STBC(STBC_VALID)
    },

  /*---- RateIndex Index 60 317, MCS Index #0-15 STBC Rate (20MHz) Mixed Mode 43.3Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11N_MIXEDMODE) | PSDURATE(HAL_PSDU_RATE_MCS_1NSS_STBC_MM_SG_43_3_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_ENABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_24_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_24_MBPS) | AMPDU(1) |
            NDBPS4TRATE(HAL_PSDU_RATE_20MHZ_MCS_IND_4_NDBPS) | NDLTFS(NDLTF_TWO) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_11_MBPS_OFFSET) |
            STBC(STBC_VALID)
    },

  /*---- RateIndex Index 61 318, MCS Index #0-15 STBC Rate (20MHz) Mixed Mode 52Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11N_MIXEDMODE) | PSDURATE(HAL_PSDU_RATE_MCS_1NSS_STBC_MM_52_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_DISABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_24_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_24_MBPS) | AMPDU(1) |
            NDBPS4TRATE(HAL_PSDU_RATE_20MHZ_MCS_IND_5_NDBPS) | NDLTFS(NDLTF_TWO) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_11_MBPS_OFFSET) |
            STBC(STBC_VALID)
    },

  /*---- RateIndex Index 62 319, MCS Index #0-15 STBC Rate (20MHz) Mixed Mode 57.8Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11N_MIXEDMODE) | PSDURATE(HAL_PSDU_RATE_MCS_1NSS_STBC_MM_SG_57_8_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_ENABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_24_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_24_MBPS) | AMPDU(1) |
            NDBPS4TRATE(HAL_PSDU_RATE_20MHZ_MCS_IND_5_NDBPS) | NDLTFS(NDLTF_TWO) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_11_MBPS_OFFSET) |
            STBC(STBC_VALID)
    },

  /*---- RateIndex Index 63 320, MCS Index #0-15 STBC Rate (20MHz) Mixed Mode 58.5Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11N_MIXEDMODE) | PSDURATE(HAL_PSDU_RATE_MCS_1NSS_STBC_MM_58_5_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_DISABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_24_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_24_MBPS) | AMPDU(1) |
            NDBPS4TRATE(HAL_PSDU_RATE_20MHZ_MCS_IND_6_NDBPS) | NDLTFS(NDLTF_TWO) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_11_MBPS_OFFSET) |
            STBC(STBC_VALID)
    },

  /*---- RateIndex Index 64 321, MCS Index #0-15 STBC Rate (20MHz) Mixed Mode 65Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11N_MIXEDMODE) | PSDURATE(HAL_PSDU_RATE_MCS_1NSS_STBC_MM_SG_65_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_ENABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_24_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_24_MBPS) | AMPDU(1) |
            NDBPS4TRATE(HAL_PSDU_RATE_20MHZ_MCS_IND_6_NDBPS) | NDLTFS(NDLTF_TWO) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_11_MBPS_OFFSET) |
            STBC(STBC_VALID)
    },

  /*---- RateIndex Index 65 322, MCS Index #0-15 STBC Rate (20MHz) Mixed Mode 65Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11N_MIXEDMODE) | PSDURATE(HAL_PSDU_RATE_MCS_1NSS_STBC_MM_65_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_DISABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_24_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_24_MBPS) | AMPDU(1) |
            NDBPS4TRATE(HAL_PSDU_RATE_20MHZ_MCS_IND_7_NDBPS) | NDLTFS(NDLTF_TWO) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_11_MBPS_OFFSET) |
            STBC(STBC_VALID)
    },

  /*---- RateIndex Index 66 323, MCS Index #0-15 STBC Rate (20MHz) Mixed Mode 72.2Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11N_MIXEDMODE) | PSDURATE(HAL_PSDU_RATE_MCS_1NSS_STBC_MM_SG_72_2_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_ENABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_24_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_24_MBPS) | AMPDU(1) |
            NDBPS4TRATE(HAL_PSDU_RATE_20MHZ_MCS_IND_7_NDBPS) | NDLTFS(NDLTF_TWO) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_11_MBPS_OFFSET) |
            STBC(STBC_VALID)
    },

  /*---- RateIndex Index 67 364, Qualcomm Proprietary STBC Rates 20MHz Greenfield Mode 68.25Mbps ---- */
    {
        PKTTYPE(PKT_TYPE_11N_GREENFIELD) | PSDURATE(HAL_PSDU_RATE_ANI_STBC_GF_68_25_MBPS) |
            BANDWIDTH(PHY_BANDWIDTH_20MHZ) | NS11b(PHY_NSS_1SPATIAL) |
            SHORTGUARD(SG_DISABLED) | CTRLRATEIDX(TPE_RT_IDX_11A_24_MBPS) |
            TXANTENNA(0) | NES(0) | TXPOWER(0),

        RSPRATEIDX(TPE_RT_IDX_11A_24_MBPS) | AMPDU(1) |
            NDBPS4TRATE(HAL_PSDU_RATE_ANI_4T_68_25_MBPS) | NDLTFS(NDLTF_FOUR) |
            NELTFS(NELTF_ZERO) | PCTRLRATEIDX(TPE_RT_IDX_11B_LONG_11_MBPS_OFFSET) |
            STBC(STBC_VALID)
    },

};


// Thr, ActualThr, Sensitivity, ieRate, SensRank, ThrRank, RateProp, TpeIdx
tHalRateInfo gHalRateInfo[HAL_MAC_MAX_RATES]  = {

    //11b rates
    {  10,  9, HALRATE_MIN_SENSITIVITY,   2,   0,   0, (RA_11B_RATES), TPE_RT_IDX_11B_LONG_1_MBPS },
    {  20,  17,  10,   4, 0, 0, (RA_11B_RATES), TPE_RT_IDX_11B_LONG_2_MBPS   },
    {  55,  41,  50,  11, 0, 0, (RA_11B_RATES), TPE_RT_IDX_11B_LONG_5_5_MBPS },
    { 110,  68, 110,  22, 0, 0, (RA_11B_RATES), TPE_RT_IDX_11B_LONG_11_MBPS  },

    //11b short preamble
    {  10,  10, HALRATE_MIN_SENSITIVITY,   2,   0,   0, (RA_11B_RATES), TPE_RT_IDX_11B_LONG_1_MBPS_DUP },
    {  20,  18,  10,   4, 0, 0, (RA_11B_SPREAMBLE), TPE_RT_IDX_11B_SHORT_2_MBPS },
    {  55,  44,  50,  11, 0, 0, (RA_11B_SPREAMBLE), TPE_RT_IDX_11B_SHORT_5_5_MBPS },
    { 110,  77, 110,  22, 0, 0, (RA_11B_SPREAMBLE), TPE_RT_IDX_11B_SHORT_11_MBPS },

    //11ag
    {  60,  50,  20,  12, 0, 0, (RA_11AG_RATES|RA_BPSK|RA_CODERATE_1_2), TPE_RT_IDX_11A_6_MBPS },
    {  90,  70,  45,  18, 0, 0, (RA_11AG_RATES|RA_BPSK|RA_CODERATE_3_4), TPE_RT_IDX_11A_9_MBPS },
    { 120, 100,  50,  24, 0, 0, (RA_11AG_RATES|RA_QPSK|RA_CODERATE_1_2), TPE_RT_IDX_11A_12_MBPS },
    { 180, 150,  75,  36, 0, 0, (RA_11AG_RATES|RA_QPSK|RA_CODERATE_3_4), TPE_RT_IDX_11A_18_MBPS },
    { 240, 190, 100,  48, 0, 0, (RA_11AG_RATES|RA_16QAM|RA_CODERATE_1_2), TPE_RT_IDX_11A_24_MBPS },
    { 360, 280, 130,  72, 0, 0, (RA_11AG_RATES|RA_16QAM|RA_CODERATE_3_4), TPE_RT_IDX_11A_36_MBPS },
    { 480, 350, 165,  96, 0, 0, (RA_11AG_RATES|RA_64QAM|RA_CODERATE_2_3), TPE_RT_IDX_11A_48_MBPS },
    { 540, 380, 180, 108, 0, 0, (RA_11AG_RATES|RA_64QAM|RA_CODERATE_3_4), TPE_RT_IDX_11A_54_MBPS },

    //HT SIMO
    {  65,  54,  30,   0, 0, 0, (RA_HT_20_SIMO|RA_BPSK|RA_CODERATE_1_2), TPE_RT_IDX_MCS_1NSS_MM_6_5_MBPS },
    { 130, 108,  60,   1, 0, 0, (RA_HT_20_SIMO|RA_QPSK|RA_CODERATE_1_2), TPE_RT_IDX_MCS_1NSS_MM_13_MBPS },
    { 195, 161,  75,   2, 0, 0, (RA_HT_20_SIMO|RA_QPSK|RA_CODERATE_3_4), TPE_RT_IDX_MCS_1NSS_MM_19_5_MBPS },
    { 260, 217, 100,   3, 0, 0, (RA_HT_20_SIMO|RA_16QAM|RA_CODERATE_1_2), TPE_RT_IDX_MCS_1NSS_MM_26_MBPS },
    { 390, 326, 120,   4, 0, 0, (RA_HT_20_SIMO|RA_16QAM|RA_CODERATE_3_4), TPE_RT_IDX_MCS_1NSS_MM_39_MBPS },
    { 520, 435, 180,   5, 0, 0, (RA_HT_20_SIMO|RA_64QAM|RA_CODERATE_2_3), TPE_RT_IDX_MCS_1NSS_MM_52_MBPS },
    { 585, 492, 200,   6, 0, 0, (RA_HT_20_SIMO|RA_64QAM|RA_CODERATE_3_4), TPE_RT_IDX_MCS_1NSS_MM_58_5_MBPS },
    { 650, 548, 220,   7, 0, 0, (RA_HT_20_SIMO|RA_64QAM|RA_CODERATE_5_6), TPE_RT_IDX_MCS_1NSS_MM_65_MBPS },

    //HT SIMO SGI
    {  72,  59,  30,   0, 0, 0, (RA_DISABLED|RA_HT_20_SIMO_SGI|RA_BPSK|RA_CODERATE_1_2), TPE_RT_IDX_MCS_1NSS_MM_SG_7_2_MBPS },
    { 144, 118,  60,   1, 0, 0, (RA_DISABLED|RA_HT_20_SIMO_SGI|RA_QPSK|RA_CODERATE_1_2), TPE_RT_IDX_MCS_1NSS_MM_SG_14_4_MBPS },
    { 217, 180,  75,   2, 0, 0, (RA_DISABLED|RA_HT_20_SIMO_SGI|RA_QPSK|RA_CODERATE_3_4), TPE_RT_IDX_MCS_1NSS_MM_SG_21_7_MBPS },
    { 289, 243, 100,   3, 0, 0, (RA_DISABLED|RA_HT_20_SIMO_SGI|RA_16QAM|RA_CODERATE_1_2), TPE_RT_IDX_MCS_1NSS_MM_SG_28_9_MBPS },
    { 434, 363, 120,   4, 0, 0, (RA_DISABLED|RA_HT_20_SIMO_SGI|RA_16QAM|RA_CODERATE_3_4), TPE_RT_IDX_MCS_1NSS_MM_SG_43_3_MBPS },
    { 578, 486, 180,   5, 0, 0, (RA_DISABLED|RA_HT_20_SIMO_SGI|RA_64QAM|RA_CODERATE_2_3), TPE_RT_IDX_MCS_1NSS_MM_SG_57_8_MBPS },
    { 650, 548, 200,   6, 0, 0, (RA_DISABLED|RA_HT_20_SIMO_SGI|RA_64QAM|RA_CODERATE_3_4), TPE_RT_IDX_MCS_1NSS_MM_SG_65_MBPS },
    { 722, 606, 230,   7, 0, 0, (RA_HT_20_SIMO_SGI|RA_64QAM|RA_CODERATE_5_6), TPE_RT_IDX_MCS_1NSS_MM_SG_72_2_MBPS },

    //SLR Rates //FIXME: Check if all the values are right?
    {   2,   1,  30,   0, 0, 0, (RA_DISABLED|RA_SLR|RA_BPSK|RA_CODERATE_1_2),  TPE_RT_IDX_SLR_0_25_MBPS },
    {   5,   3,  60,   1, 0, 0, (RA_DISABLED|RA_SLR|RA_QPSK|RA_CODERATE_1_2),  TPE_RT_IDX_SLR_0_5_MBPS },

    //GF SIMO
    {  65,  54,  30,   0, 0, 0, (RA_DISABLED|RA_HT_20_SIMO|RA_BPSK|RA_CODERATE_1_2),  TPE_RT_IDX_MCS_1NSS_GF_6_5_MBPS },
    { 130, 108,  60,   1, 0, 0, (RA_DISABLED|RA_HT_20_SIMO|RA_QPSK|RA_CODERATE_1_2),  TPE_RT_IDX_MCS_1NSS_GF_13_MBPS },
    { 195, 161,  75,   2, 0, 0, (RA_DISABLED|RA_HT_20_SIMO|RA_QPSK|RA_CODERATE_3_4),  TPE_RT_IDX_MCS_1NSS_GF_19_5_MBPS },
    { 260, 217, 100,   3, 0, 0, (RA_DISABLED|RA_HT_20_SIMO|RA_16QAM|RA_CODERATE_1_2), TPE_RT_IDX_MCS_1NSS_GF_26_MBPS },
    { 390, 326, 120,   4, 0, 0, (RA_DISABLED|RA_HT_20_SIMO|RA_16QAM|RA_CODERATE_3_4), TPE_RT_IDX_MCS_1NSS_GF_39_MBPS },
    { 520, 435, 180,   5, 0, 0, (RA_DISABLED|RA_HT_20_SIMO|RA_64QAM|RA_CODERATE_2_3), TPE_RT_IDX_MCS_1NSS_GF_52_MBPS },
    { 585, 492, 200,   6, 0, 0, (RA_DISABLED|RA_HT_20_SIMO|RA_64QAM|RA_CODERATE_3_4), TPE_RT_IDX_MCS_1NSS_GF_58_5_MBPS },
    { 650, 548, 220,   7, 0, 0, (RA_DISABLED|RA_HT_20_SIMO|RA_64QAM|RA_CODERATE_5_6), TPE_RT_IDX_MCS_1NSS_GF_65_MBPS },

    //Qualcomm proprietary rates //FIXME: Check if all the values are right?
    { 682, 576, 230, 1100,0, 0, (RA_DISABLED|RA_QCOMM_20_SIMO|RA_64QAM|RA_CODERATE_7_8), TPE_RT_IDX_ANI_GF_68_25_MBPS },

    //STBC GF SIMO
    {  65,  54,  30,   0, 0, 0, (RA_DISABLED|RA_STBC|RA_HT_20_SIMO|RA_BPSK|RA_CODERATE_1_2),  TPE_RT_IDX_MCS_1NSS_STBC_GF_6_5_MBPS },
    { 130, 108,  60,   1, 0, 0, (RA_DISABLED|RA_STBC|RA_HT_20_SIMO|RA_QPSK|RA_CODERATE_1_2),  TPE_RT_IDX_MCS_1NSS_STBC_GF_13_MBPS },
    { 195, 161,  75,   2, 0, 0, (RA_DISABLED|RA_STBC|RA_HT_20_SIMO|RA_QPSK|RA_CODERATE_3_4),  TPE_RT_IDX_MCS_1NSS_STBC_GF_19_5_MBPS },
    { 260, 217, 100,   3, 0, 0, (RA_DISABLED|RA_STBC|RA_HT_20_SIMO|RA_16QAM|RA_CODERATE_1_2), TPE_RT_IDX_MCS_1NSS_STBC_GF_26_MBPS },
    { 390, 326, 120,   4, 0, 0, (RA_DISABLED|RA_STBC|RA_HT_20_SIMO|RA_16QAM|RA_CODERATE_3_4), TPE_RT_IDX_MCS_1NSS_STBC_GF_39_MBPS },
    { 520, 435, 180,   5, 0, 0, (RA_DISABLED|RA_STBC|RA_HT_20_SIMO|RA_64QAM|RA_CODERATE_2_3), TPE_RT_IDX_MCS_1NSS_STBC_GF_52_MBPS },
    { 585, 492, 200,   6, 0, 0, (RA_DISABLED|RA_STBC|RA_HT_20_SIMO|RA_64QAM|RA_CODERATE_3_4), TPE_RT_IDX_MCS_1NSS_STBC_GF_58_5_MBPS },
    { 650, 548, 220,   7, 0, 0, (RA_DISABLED|RA_STBC|RA_HT_20_SIMO|RA_64QAM|RA_CODERATE_5_6), TPE_RT_IDX_MCS_1NSS_STBC_GF_65_MBPS },

    //STBC HT SIMO
    {  65,  54,  30,   0, 0, 0, (RA_DISABLED|RA_STBC|RA_HT_20_SIMO|RA_BPSK|RA_CODERATE_1_2),      TPE_RT_IDX_MCS_1NSS_STBC_MM_6_5_MBPS },
    {  72,  59,  30,   0, 0, 0, (RA_DISABLED|RA_STBC|RA_HT_20_SIMO_SGI|RA_BPSK|RA_CODERATE_1_2),  TPE_RT_IDX_MCS_1NSS_STBC_MM_SG_7_2_MBPS },
    { 130, 108,  60,   1, 0, 0, (RA_DISABLED|RA_STBC|RA_HT_20_SIMO|RA_QPSK|RA_CODERATE_1_2),      TPE_RT_IDX_MCS_1NSS_STBC_MM_13_MBPS },
    { 144, 118,  60,   1, 0, 0, (RA_DISABLED|RA_STBC|RA_HT_20_SIMO_SGI|RA_QPSK|RA_CODERATE_1_2),  TPE_RT_IDX_MCS_1NSS_STBC_MM_SG_14_4_MBPS },
    { 195, 161,  75,   2, 0, 0, (RA_DISABLED|RA_STBC|RA_HT_20_SIMO|RA_QPSK|RA_CODERATE_3_4),      TPE_RT_IDX_MCS_1NSS_STBC_MM_19_5_MBPS },
    { 217, 180,  75,   2, 0, 0, (RA_DISABLED|RA_STBC|RA_HT_20_SIMO_SGI|RA_QPSK|RA_CODERATE_3_4),  TPE_RT_IDX_MCS_1NSS_STBC_MM_SG_21_7_MBPS },
    { 260, 217, 100,   3, 0, 0, (RA_DISABLED|RA_STBC|RA_HT_20_SIMO|RA_16QAM|RA_CODERATE_1_2),     TPE_RT_IDX_MCS_1NSS_STBC_MM_26_MBPS },
    { 289, 243, 100,   3, 0, 0, (RA_DISABLED|RA_STBC|RA_HT_20_SIMO_SGI|RA_16QAM|RA_CODERATE_1_2), TPE_RT_IDX_MCS_1NSS_STBC_MM_SG_28_9_MBPS },
    { 390, 326, 120,   4, 0, 0, (RA_DISABLED|RA_STBC|RA_HT_20_SIMO|RA_16QAM|RA_CODERATE_3_4),     TPE_RT_IDX_MCS_1NSS_STBC_MM_39_MBPS },
    { 434, 363, 120,   4, 0, 0, (RA_DISABLED|RA_STBC|RA_HT_20_SIMO_SGI|RA_16QAM|RA_CODERATE_3_4), TPE_RT_IDX_MCS_1NSS_STBC_MM_SG_43_3_MBPS },
    { 520, 435, 180,   5, 0, 0, (RA_DISABLED|RA_STBC|RA_HT_20_SIMO|RA_64QAM|RA_CODERATE_2_3),     TPE_RT_IDX_MCS_1NSS_STBC_MM_52_MBPS },
    { 578, 486, 180,   5, 0, 0, (RA_DISABLED|RA_STBC|RA_HT_20_SIMO_SGI|RA_64QAM|RA_CODERATE_2_3), TPE_RT_IDX_MCS_1NSS_STBC_MM_SG_57_8_MBPS },
    { 585, 492, 200,   6, 0, 0, (RA_DISABLED|RA_STBC|RA_HT_20_SIMO|RA_64QAM|RA_CODERATE_3_4),     TPE_RT_IDX_MCS_1NSS_STBC_MM_58_5_MBPS },
    { 650, 548, 220,   7, 0, 0, (RA_DISABLED|RA_STBC|RA_HT_20_SIMO_SGI|RA_64QAM|RA_CODERATE_5_6), TPE_RT_IDX_MCS_1NSS_STBC_MM_SG_65_MBPS },
    { 650, 548, 200,   6, 0, 0, (RA_DISABLED|RA_STBC|RA_HT_20_SIMO|RA_64QAM|RA_CODERATE_3_4),     TPE_RT_IDX_MCS_1NSS_STBC_MM_65_MBPS },
    { 722, 606, 230,   7, 0, 0, (RA_DISABLED|RA_STBC|RA_HT_20_SIMO_SGI|RA_64QAM|RA_CODERATE_5_6), TPE_RT_IDX_MCS_1NSS_STBC_MM_SG_72_2_MBPS },

    //STBC Qualcomm proprietary rates
    { 682, 576, 230, 1100,0, 0, (RA_DISABLED|RA_STBC|RA_QCOMM_20_SIMO|RA_64QAM|RA_CODERATE_7_8), TPE_RT_IDX_ANI_STBC_GF_68_25_MBPS },

  /* reserved , don't touch */
    {   0,   0, HALRATE_MIN_SENSITIVITY,  0, 0, 0, (RA_DISABLED), TPE_RT_IDX_INVALID }, /* HALRATE_INVALID*/
};


// Mapping the rates in the user configuration to the TPE rates
tTpeRateIdx gHalUserFixedRateCfgToTpeRateTable[] =
{
    TPE_RT_IDX_MAX_RATES,                           //"Adaptive"
    TPE_RT_IDX_11B_LONG_1_MBPS,                     //"Legacy 1"
    TPE_RT_IDX_11B_LONG_2_MBPS,                     //"Legacy 2"
    TPE_RT_IDX_11B_LONG_5_5_MBPS,                   //"Legacy 5.5"
    TPE_RT_IDX_11B_LONG_11_MBPS,                    //"Legacy 11"
    TPE_RT_IDX_11A_6_MBPS,                          //"Legacy 6"
    TPE_RT_IDX_11A_9_MBPS,                          //"Legacy 9"
    TPE_RT_IDX_11A_12_MBPS,                         //"Legacy 12"
    TPE_RT_IDX_11A_18_MBPS,                         //"Legacy 18"
    TPE_RT_IDX_11A_24_MBPS,                         //"Legacy 24"
    TPE_RT_IDX_11A_36_MBPS,                         //"Legacy 36"
    TPE_RT_IDX_11A_48_MBPS,                         //"Legacy 48"
    TPE_RT_IDX_11A_54_MBPS,                         //"Legacy 54"
    TPE_RT_IDX_MCS_1NSS_MM_6_5_MBPS,                //"MCS0/20M 6.5"
    TPE_RT_IDX_MCS_1NSS_MM_13_MBPS,                 //"MCS1/20M 13"
    TPE_RT_IDX_MCS_1NSS_MM_19_5_MBPS,               //"MCS2/20M 19.5"
    TPE_RT_IDX_MCS_1NSS_MM_26_MBPS,                 //"MCS3/20M 26"
    TPE_RT_IDX_MCS_1NSS_MM_39_MBPS,                 //"MCS4/20M 39"
    TPE_RT_IDX_MCS_1NSS_MM_52_MBPS,                 //"MCS5/20M 52"
    TPE_RT_IDX_MCS_1NSS_MM_58_5_MBPS,               //"MCS6/20M 58.5"
    TPE_RT_IDX_MCS_1NSS_MM_65_MBPS,                 //"MCS7/20M 65"
    TPE_RT_IDX_MCS_1NSS_MM_SG_7_2_MBPS,             //"MCS0/20M/SGI 7.2"
    TPE_RT_IDX_MCS_1NSS_MM_SG_14_4_MBPS,            //"MCS1/20M/SGI 14.4"
    TPE_RT_IDX_MCS_1NSS_MM_SG_21_7_MBPS,            //"MCS2/20M/SGI 21.7"
    TPE_RT_IDX_MCS_1NSS_MM_SG_28_9_MBPS,            //"MCS3/20M/SGI 28.9"
    TPE_RT_IDX_MCS_1NSS_MM_SG_43_3_MBPS,            //"MCS4/20M/SGI 43.3"
    TPE_RT_IDX_MCS_1NSS_MM_SG_57_8_MBPS,            //"MCS5/20M/SGI 57.8"
    TPE_RT_IDX_MCS_1NSS_MM_SG_65_MBPS,              //"MCS6/20M/SGI 65"
    TPE_RT_IDX_MCS_1NSS_MM_SG_72_2_MBPS,            //"MCS7/20M/SGI 72.2"
    TPE_RT_IDX_SLR_0_25_MBPS,                       //"SLR 0.25"
    TPE_RT_IDX_SLR_0_5_MBPS,                        //"SLR 0.5"
    TPE_RT_IDX_ANI_GF_68_25_MBPS,                   //"QC Prop 68.25"
};


eHalStatus halRate_updateRespRateTable(tpAniSirGlobal pMac, tHalMacRate (*pRefResponseRateTable) [RA_TOTAL_MODULATION][RA_TOTAL_CODERATE]);

/* Convert HAL rate index to TPE rate index*/
tTpeRateIdx halRate_halRate2TpeRate(tHalMacRate halRate)
{
    if(halRate >= HALRATE_INVALID)
        return TPE_RT_IDX_INVALID;
    else
        return HAL_RA_TPERATEIDX_GET(halRate);
}

/* Convert TPE rate index to HAL rate index */
tHalMacRate halRate_tpeRate2HalRate(tANI_U32 tpeRate)
{
    if(tpeRate == TPE_RT_IDX_INVALID)
        return HALRATE_INVALID;
    else if(tpeRate < MAX_LIBRA_RATE_NUM){
        return (tHalMacRate)tpeRate;
    }
    return HALRATE_INVALID;
}


eHalStatus halRate_getRateProperty(tpAniSirGlobal pMac,
        tHalMacRate halRate, tANI_U32 *pRateProperty)
{
    if(halRate >= HALRATE_INVALID)
        return eHAL_STATUS_FAILURE;
    else{
        *pRateProperty = gHalRateInfo[halRate].rateProperty;
        return eHAL_STATUS_SUCCESS;
    }
}

eHalStatus halRate_getPacketTypeFromHalRate( tHalMacRate halRate,
        tANI_U8 *pPacketType )
{
    eHalStatus status = eHAL_STATUS_INVALID_PARAMETER;
    tTpeRateIdx tpeRateId;
    tpTpeRateTable  pRate;

    if ( pPacketType )
    {
        tpeRateId = halRate_halRate2TpeRate( halRate );

        if(tpeRateId != TPE_RT_IDX_INVALID)
        {
            pRate = (tpTpeRateTable) (&tpeSramRateTable[tpeRateId]);
            *pPacketType = (tANI_U8) pRate->pktType;
            status = eHAL_STATUS_SUCCESS;
        }
    }

    return status;
}


/* Is the given rate a valid STBC rate */
eHalStatus halRate_checkValidStbcRate( tHalMacRate halRate,
        tANI_U32 *pStbcValid)
{
    eHalStatus status = eHAL_STATUS_INVALID_PARAMETER;
    tTpeRateIdx tpeRateId;
    tpTpeRateTable  pRate;

    if (pStbcValid) {
        tpeRateId = halRate_halRate2TpeRate( halRate );

        if(tpeRateId != TPE_RT_IDX_INVALID) {
            pRate = (tpTpeRateTable) (&tpeSramRateTable[tpeRateId]);
            *pStbcValid = (tANI_U8) pRate->stbcValid;
            status = eHAL_STATUS_SUCCESS;
        }
    }

    return status;
}

/* Converts a user specified fixed rate value from CFG to TPE rate index */
tTpeRateIdx halRate_cfgFixedRate2TpeRate(tANI_U32 userCfgFixedrate)
{
    tANI_U32 numRates = (sizeof(gHalUserFixedRateCfgToTpeRateTable)/sizeof(tTpeRateIdx));

    if (userCfgFixedrate < numRates) {
        return (tTpeRateIdx)gHalUserFixedRateCfgToTpeRateTable[userCfgFixedrate];
    } else {
        return (tTpeRateIdx)TPE_RT_IDX_INVALID;
    }
}


/* ------------------------------------------------
 * FUNCTION: halRate_getTpeRateCmd()
 *
 * NOTE:
 *   For a given rateIndex, get the corresponding
 *   MPI command from the rate table.
 * ------------------------------------------------*/
eHalStatus halRate_getTpeRateCmd(tpAniSirGlobal pMac, tANI_U8 *mpiCmd, tANI_U32 rateIndex)
{
    palCopyMemory(pMac->hHdd, (void *)mpiCmd,
            (void *)(&tpeSramRateTable[rateIndex]), sizeof(tTpeSramRateTable));

    return eHAL_STATUS_SUCCESS;
}

/* ------------------------------------------------
 * FUNCTION: halRate_getRateTableInfo()
 *
 * NOTE:
 *   For a given rateIndex, get the corresponding
 *   Rate Info from the rate table.
 * ------------------------------------------------*/
eHalStatus halRate_getRateTableInfo(tpAniSirGlobal pMac,
        tpTpeRateTable pRateInfo, tANI_U32 rateIndex)
{
    if ( !(HAL_RATETABLE_IS_RATEINDEX_VALID(rateIndex))) {
        HALLOGW( halLog( pMac, LOGW,
                FL("Invalid rateIndex %d. Must be in the range[%d - %d]\n"),
                rateIndex, HAL_RATETABLE_RATEINDEX_BEGIN,
                HAL_RATETABLE_RATEINDEX_END));
        return eHAL_STATUS_FAILURE;
    }

    palCopyMemory( pMac->hHdd, (void *)pRateInfo,
            (void *)(&halRateTable[rateIndex].tpeRateTable), sizeof(tTpeRateTable));

    return eHAL_STATUS_SUCCESS;
}


#ifdef RA_CB_ENABLED
eHalStatus
halRate_tpeRateTableToFW(tpAniSirGlobal pMac, int startIndex, int endIndex)
{
    int i;
    eHalStatus status;
    tTpeSramRateTable tpeRateTable[HAL_MAC_MAX_TX_RATES];

    if(endIndex > HAL_MAC_MAX_TX_RATES)
        return eHAL_STATUS_INVALID_PARAMETER;

    for (i=startIndex; i < endIndex; i++) {
        palCopyMemory(pMac->hHdd, (void *)(&tpeRateTable[i]), (void *)&halRateTable[i].tpeRateTable,
            sizeof(tTpeRateTable));
        }
    status = halWriteDeviceMemory(pMac, QWLANFW_MEMMAP_TPE_RATE_TABLE+sizeof(tTpeSramRateTable)*startIndex, \
    &tpeRateTable[startIndex], sizeof(tTpeSramRateTable)*(endIndex-startIndex));
    return status;
        }
#endif /* RA_CB_ENABLED */

eHalStatus halRate_halRateInfoTableToFW(tpAniSirGlobal pMac, int startIndex, int endIndex)
{
    eHalStatus status;

    if(endIndex > HAL_MAC_MAX_TX_RATES)
        return eHAL_STATUS_INVALID_PARAMETER;

    status = halWriteDeviceMemory(pMac, QWLANFW_MEMMAP_HAL_RATE_INFO+sizeof(tHalRateInfo)*startIndex, \
        &gHalRateInfo[startIndex], sizeof(tHalRateInfo)*(endIndex-startIndex));
    return status;
        }

eHalStatus halRate_TxPwrIndexToFW(tpAniSirGlobal pMac, int startIndex, int endIndex)
{
    tANI_U8   halRateTxPwrIndexTable[CEIL_ALIGN(HAL_MAC_MAX_TX_RATES,4)] = { 0, }; // little endian
#ifdef ANI_LITTLE_BYTE_ENDIAN /* if host is little endian, firmware needs big endian */
    tANI_U32 *ptr;
#endif
    int startIndex_4, endIndex_4;
    eHalStatus status;
    int i;

    if(endIndex > HAL_MAC_MAX_TX_RATES)
        return eHAL_STATUS_INVALID_PARAMETER;

    startIndex &= ~3;
    endIndex = CEIL_ALIGN((endIndex+(startIndex&3)), 4);

    startIndex_4 = startIndex >> 2;
    endIndex_4 = endIndex >> 2;

    /* 1. construct pwrIndexTable (extract from halRateInfo) */
    for(i=0; i<HAL_MAC_MAX_TX_RATES; i++) {
        halRateTxPwrIndexTable[i] = halRateTable[i].txPwr;
    }
#ifdef ANI_LITTLE_BYTE_ENDIAN /* if host is little endian, firmware needs big endian */
    /* 2. contruct big endian format for FW (byte swap from little endian */
    ptr = (tANI_U32 *)&halRateTxPwrIndexTable[startIndex_4];
    // Note that U8 array needs to be byte-swapped before sending palWriteDevice.
    for(i=startIndex_4; i<endIndex_4;i++) {
        *ptr = HTOFL(*ptr);
        ptr++;
        }
#endif

    /* 3. write to firmware */
    status = halWriteDeviceMemory(pMac, QWLANFW_MEMMAP_RATE_TXPWR_TABLE+sizeof(tANI_U32)*startIndex_4, \
        &halRateTxPwrIndexTable[startIndex_4], sizeof(tANI_U32)*(endIndex_4-startIndex_4));
    return status;
}    
/* Function to initialize the TPE rate tables during halStart */
eHalStatus halRate_Start(tHalHandle hHal, void *arg)
{
    eHalStatus status = eHAL_STATUS_FAILURE;
    tpAniSirGlobal pMac = (tpAniSirGlobal)hHal;
    tANI_U32 i, value;
    (void) arg;

    palFillMemory(hHal, &halRateTable[0], sizeof(halRateTable), 0);
    // initialize shared memory between the host and firmware
    halZeroDeviceMemory(pMac, QWLANFW_MEMMAP_RA_SHARED_TABLE_ADDR, \
        (QWLANFW_MEMMAP_RA_SHARED_TABLE_END_ADDR - QWLANFW_MEMMAP_RA_SHARED_TABLE_ADDR));

    /* --- Initialize all entries of the Rate Table --- */
    // Initialize Hal rate table with the TPE rates
    for (i=0; i < MAX_LIBRA_RATE_NUM; i++) {
        palCopyMemory(pMac->hHdd, (void *)&halRateTable[i].tpeRateTable,
                (void *)(&tpeSramRateTable[i]), sizeof(tTpeRateTable));
    }

    // Set the SW added offset to the 11G rate index as zero.
    value = 0;
    if (halWriteRegister(pMac, QWLAN_TPE_SW_11G_CTRL_INDEX_OFFSET_REG,
                value) != eHAL_STATUS_SUCCESS) {
        return eHAL_STATUS_FAILURE;
    }

    if (halRate_UpdateRateTablePower(pMac,
                (tTpeRateIdx)MIN_LIBRA_RATE_NUM, (tTpeRateIdx)MAX_LIBRA_RATE_NUM, FALSE) != eHAL_STATUS_SUCCESS) {
        HALLOGE(halLog(pMac, LOGE, FL("TPE rate table initialization failed \n")));
        return eHAL_STATUS_FAILURE;
    }

    if ( halRate_updateRespRateTable(pMac,
                &defRefBasicRateTable) != eHAL_STATUS_SUCCESS ) {
        HALLOGE(halLog(pMac, LOGE, FL("halRate_updateRespRateTable() failed \n")));
        return eHAL_STATUS_FAILURE;
    }

    // Download the table to the target.
#ifdef RA_CB_ENABLED
    status = halRate_tpeRateTableToFW(pMac, 0, HAL_MAC_MAX_TX_RATES);
#endif /* RA_CB_ENABLED */
    status = halRate_halRateInfoTableToFW(pMac, 0, HAL_MAC_MAX_TX_RATES);

    // Write the entire update rate table into TPE
    status = halRate_UpdateTpeRateTable(pMac, MIN_LIBRA_RATE_NUM, MAX_LIBRA_RATE_NUM);

    return status;
}


/* -------------------------------------------------------
 * FUNCTION:  halRate_UpdateTpeRateTable()
 *
 * NOTE:  This function updates TPE rate table with the information from halRateTable.
 * @param hHal - halhandle
 * @param arg  - not used right now
 * @return eHalStatus - propagates the return code from the functions called.
 * -------------------------------------------------------
 */
eHalStatus halRate_UpdateTpeRateTable(tpAniSirGlobal pMac, tANI_U16 startRate, tANI_U16 endRate)
{
    tANI_U16 i;
    eHalStatus status = eHAL_STATUS_FAILURE;
    tpTpeSramRateTable pTpeRateTableEntry;

    HALLOGE( halLog(pMac, LOGE, FL("Updating TPE Rate Table, Rate: Start = %d End = %d"), startRate, endRate));

    for (i = startRate; i < endRate; i++) {
        pTpeRateTableEntry = (tpTpeSramRateTable)&halRateTable[i].tpeRateTable;

        if ((status = halTpe_RateTableWrite(pMac, i, pTpeRateTableEntry->word0,
                        pTpeRateTableEntry->word1)) != eHAL_STATUS_SUCCESS) {
            return status;
        }
    }

    return status;
}

#if 0 //defined but never referenced. Comment out.
/* -------------------------------------------------------
 * FUNCTION:  halRate_UpdateBcastRateTable()
 *
 * NOTE:  This function updates TPE rate table for bcast rate with the information from halRateTable.
 * @param hHal - halhandle
 * @param bcastRateIdx - broadcast rate index
 * @return eHalStatus - propagates the return code from the functions called.
 * -------------------------------------------------------
 */
static eHalStatus halRate_UpdateBcastRateTable(tHalHandle hHal, tANI_U32 bcastRateIdx)
{
    eHalStatus status = eHAL_STATUS_SUCCESS;
    tpTpeSramRateTable pTpeRateTableEntry;
    tpAniSirGlobal pMac = (tpAniSirGlobal)hHal;

    if(bcastRateIdx >= MAX_LIBRA_RATE_NUM)
    {
        HALLOGE( halLog(pMac, LOGE, FL("rate index is invalid\n")));
        status = eHAL_STATUS_FAILURE;
    }
    else
    {
        pTpeRateTableEntry = (tpTpeSramRateTable)&halRateTable[bcastRateIdx].tpeRateTable;

        status = halTpe_RateTableWrite(pMac, bcastRateIdx, pTpeRateTableEntry->word0,
                        pTpeRateTableEntry->word1);
        if(eHAL_STATUS_SUCCESS != status)
            HALLOGE( halLog(pMac, LOGE, FL("halTpe_RateTableWrite failed\n")));
    }

    return status;
}
#endif

/* Function to get the CFG set protection mode and if AUTO, then decide
 * which protection mode is suitable */
void halRate_getProtectionInfo(tpAniSirGlobal pMac, tANI_U32 staId,
        tANI_U32 type, tANI_U32 retry, tANI_U32 halDataRateIdx,
        tANI_U32 *pProtPolicy)
{
    tTpeProtPolicy protPolicy = TPE_RATE_PROTECTION_NONE;
    tANI_U32 rtsThreshold = HAL_RTS_THRESHOLD_MAX;
    tANI_BOOLEAN bssProt = FALSE;
    tpBssStruct bssTable = (tpBssStruct) pMac->hal.halMac.bssTable;
    tpHalRaGlobalInfo pGlobInfo = &pMac->hal.halRaInfo;

    // Get the CFG set protection policy
    halUtil_getProtectionMode(pMac, &protPolicy);
    pGlobInfo->protPolicy = (tANI_U8)protPolicy;

    // Get the CFG set RTS threshold
    if (wlan_cfgGetInt(pMac, WNI_CFG_RTS_THRESHOLD,
                &rtsThreshold) != eSIR_SUCCESS) {
        HALLOGE(halLog(pMac, LOGE, FL("cfgGet WNI_CFG_RTS_THRESHOLD Failed\n")));
    }
    pGlobInfo->rtsThreshold = (tANI_U16)rtsThreshold;

    // Check protection is set in the BSS
    if ((bssTable->bssRaInfo.u.bit.llbCoexist) &&
            (HALRATE_IS_11B(halDataRateIdx) == 0) &&
            (pMac->hal.currentRfBand == eRF_BAND_2_4_GHZ)) {
        bssProt = TRUE;
    }

    // If RTS threshold is less than the max, override the protection
    // policy to RTS protection, as the HW relies on the protection mode
    // to be set to RTS for the RTS threshold to take effect
    if(rtsThreshold < HAL_RTS_THRESHOLD_MAX) {
        protPolicy = TPE_RATE_PROTECTION_RTS;
    }

    // If the BSS protection is turned ON, check the configured
    if(bssProt) {
        switch(protPolicy) {
            case TPE_RATE_PROTECTION_NONE:
                break;

            case TPE_RATE_PROTECTION_CTS:
                break;

            case TPE_RATE_PROTECTION_RTS:
                rtsThreshold = 0;
                break;

            case TPE_RATE_PROTECTION_DUAL_CTS:
                break;

            case TPE_RATE_PROTECTION_RTS_ALWAYS:
                protPolicy = TPE_RATE_PROTECTION_RTS;
                rtsThreshold = 0;
                break;

            case TPE_RATE_PROTECTION_AUTO:
                protPolicy = TPE_RATE_PROTECTION_CTS;

                break;
            default:
                protPolicy = TPE_RATE_PROTECTION_NONE;
                break;
        }
    } else {
        // If RTS threshold is max then protection is not required to be
        // enabled
        if(rtsThreshold == HAL_RTS_THRESHOLD_MAX) {
            protPolicy = TPE_RATE_PROTECTION_NONE;
        }
    }

    *pProtPolicy = protPolicy;

    // Set the modified RTS threshold in to the HW
    halTpe_SetProtectionThreshold(pMac, rtsThreshold);

}


/* ------------------------------------------
 * FUNCTION:  halRate_changeStaRate()
 *
 * NOTE:
 *   For a given staid and chnl, change primary,
 *   secondary and tertiary rates
 * ------------------------------------------ */
void  halRate_changeStaRate(tpAniSirGlobal pMac, tANI_U32 staId,
        tANI_U32 rateType, tHalMacRate halPriRateIdx,
        tHalMacRate halSecRateIdx, tHalMacRate halTerRateIdx )
{
    Qwlanfw_RaForceStaRateMsgType msgBody;

    /* send message to firmware */
    msgBody.staId = staId;
    msgBody.rateType = rateType;
    msgBody.priRateIdx = (tANI_U32)halPriRateIdx;
    msgBody.secRateIdx = (tANI_U32)halSecRateIdx;
    msgBody.terRateIdx = (tANI_U32)halTerRateIdx;

    // Send the RA start request to firmware
    halMacRaUpdateReq(pMac, QWLANFW_RA_FORCE_STA_RATE, sizeof(Qwlanfw_RaForceStaRateMsgType), (tANI_U8 *)&msgBody);
    return ;
}

/* ---------------------------------------------------------
\fn      halRate_getPowerIndex
\brief   For a given rateIndex, return the corresponding
\        txDemandedPower value.
\param   tpAniSirGlobal      pMac
\param   tANI_U32            rateIndex
\param   tPwrTemplateIndex   pwrIndex
\return  eHalStatus
  -----------------------------------------------------------*/
eHalStatus halRate_getPowerIndex(tpAniSirGlobal pMac, tANI_U32 rateIndex,
        tPwrTemplateIndex *pwrIndex)
{
    if ( !(HAL_RATETABLE_IS_RATEINDEX_VALID(rateIndex)) ) {
        //HALLOGE( halLog(pMac, LOGE, FL("Invalid rateIndex %d. Must be [%d, %d] \n"),
        //       rateIndex, HAL_RATETABLE_RATEINDEX_BEGIN, HAL_RATETABLE_RATEINDEX_END));
        return eHAL_STATUS_FAILURE;
    }

    *pwrIndex = (tPwrTemplateIndex)halRateTable[rateIndex].txPwr;
    HALLOGW( halLog(pMac, LOGW, FL("tpeRateIndex %d:  txPower=%d \n"), rateIndex, *pwrIndex));

    return eHAL_STATUS_SUCCESS;
}

eHalStatus
halMacRaTxPktCountFromFW(
    tpAniSirGlobal  pMac,
    tANI_U32       *pktCntArray)
{
    eHalStatus status;

    status = halReadDeviceMemory(pMac, QWLANFW_MEMMAP_RA_RATE_TX_COUNT, \
        (void *)(pktCntArray), sizeof(tANI_U32)*HAL_MAC_MAX_TX_RATES);

    return status;
}    

/* Funtion to update Tx power only for a given rate into the Hal Rate table
 * and the TPE rate table */
eHalStatus halRate_UpdateTpeTxPowerRateEntry(tpAniSirGlobal pMac, tANI_U32 rateIdx)
{
    eHalStatus status = eHAL_STATUS_SUCCESS;

    // Get the tx power for this rate and update it in the hal rate table
    halRate_UpdateRateTablePower(pMac, (tTpeRateIdx)rateIdx, (tTpeRateIdx)(rateIdx+1), TRUE);

    return status;
}


/*
 * FUNCTION:  halRate_UpdateRateTxPower
 *
 * NOTE:
 *   For a given rateIndex, update the mpiCmdTable
 *   with the new "txDemandedPower" value. Also,
 *   update the corresponding MPI command table
 *   in the global rate table.
 * NOTE2: In case RA in FW, caller should decide whether
 * this function is called many times (in a loop) or only once.
 * Since this power information should pass to firmware and
 * we don't want to access to firmware each time if this function is called in series,
 * it's caller's responsibility to call halRate_TxPwrIndexToFW function() after this function call.
 */
void halRate_UpdateRateTxPower(tpAniSirGlobal pMac,
        tTpeRateIdx rateIndex, tPwrTemplateIndex power)
{
    if (rateIndex == TPE_RT_IDX_INVALID) {
        return;
    }

    // Update the tx power into the local halRatetable
    halRateTable[rateIndex].txPwr = power;

    return;
}


/* Function to update the TX power for a given rate directly into the halRate and
 * TPE rate table */
void halRate_SetTpeTxPower(tpAniSirGlobal pMac,
        tTpeRateIdx rateIndex, tPwrTemplateIndex power)
{
    if (rateIndex == TPE_RT_IDX_INVALID) {
        return;
    }

    // Update the TX power for the rate in the local cache,
    // which will be used as a reference to update the tx power in the
    // TPE station descriptor when the rate changes.
    halRate_UpdateRateTxPower(pMac, rateIndex, power);
    halRate_TxPwrIndexToFW(pMac, rateIndex, rateIndex+1);
    halMacRaUpdateParamReq(pMac, RA_UPDATE_TXPWR_INFO, ((tANI_U8)rateIndex << 24) | ((tANI_U8)(rateIndex+1) << 16) | ((tANI_U8)power << 8));

    // Update the cntrl/rsp rate tx power locally and in the TPE if the updateTpeHw flag is set.
    halRate_UpdateCtrlRspTxPower(pMac, rateIndex, power, TRUE);

    return;
}

void halRate_DumpRateTxPower(tpAniSirGlobal pMac)
{
    tANI_U8 index;

    for (index = MIN_LIBRA_RATE_NUM; index < MAX_LIBRA_RATE_NUM; index++) {
        HALLOGE(halLog(pMac, LOGE, "RateId %d = Power %02d", index, halRateTable[index].txPwr));
    }
    return;
}



const eHalPhyRates macPhyRateIndex[TPE_RT_IDX_MAX_RATES] =
{
    HAL_PHY_RATE_11B_LONG_1_MBPS,           // TPE_RT_IDX_11B_LONG_1_MBPS = TPE_RT_IDX_11B_RATE_LONG_PR_BASE_OFFSET,
    HAL_PHY_RATE_11B_LONG_2_MBPS,           // TPE_RT_IDX_11B_LONG_2_MBPS,
    HAL_PHY_RATE_11B_LONG_5_5_MBPS,         // TPE_RT_IDX_11B_LONG_5_5_MBPS,
    HAL_PHY_RATE_11B_LONG_11_MBPS,          // TPE_RT_IDX_11B_LONG_11_MBPS,
    HAL_PHY_RATE_11B_LONG_1_MBPS,           // TPE_RT_IDX_11B_LONG_1_MBPS_DUP = TPE_RT_IDX_11B_RATE_SHORT_PR_BASE_OFFSET,
    HAL_PHY_RATE_11B_SHORT_2_MBPS,          // TPE_RT_IDX_11B_SHORT_2_MBPS,
    HAL_PHY_RATE_11B_SHORT_5_5_MBPS,        // TPE_RT_IDX_11B_SHORT_5_5_MBPS,
    HAL_PHY_RATE_11B_SHORT_11_MBPS,         // TPE_RT_IDX_11B_SHORT_11_MBPS,
    HAL_PHY_RATE_11A_6_MBPS,                // TPE_RT_IDX_11A_6_MBPS = 8,
    HAL_PHY_RATE_11A_9_MBPS,                // TPE_RT_IDX_11A_9_MBPS,
    HAL_PHY_RATE_11A_12_MBPS,               // TPE_RT_IDX_11A_12_MBPS,
    HAL_PHY_RATE_11A_18_MBPS,               // TPE_RT_IDX_11A_18_MBPS,
    HAL_PHY_RATE_11A_24_MBPS,               // TPE_RT_IDX_11A_24_MBPS,
    HAL_PHY_RATE_11A_36_MBPS,               // TPE_RT_IDX_11A_36_MBPS,
    HAL_PHY_RATE_11A_48_MBPS,               // TPE_RT_IDX_11A_48_MBPS,
    HAL_PHY_RATE_11A_54_MBPS,               // TPE_RT_IDX_11A_54_MBPS,
    HAL_PHY_RATE_MCS_1NSS_6_5_MBPS,         // TPE_RT_IDX_MCS_1NSS_MM_6_5_MBPS = 16,
    HAL_PHY_RATE_MCS_1NSS_13_MBPS,          // TPE_RT_IDX_MCS_1NSS_MM_13_MBPS,
    HAL_PHY_RATE_MCS_1NSS_19_5_MBPS,        // TPE_RT_IDX_MCS_1NSS_MM_19_5_MBPS,
    HAL_PHY_RATE_MCS_1NSS_26_MBPS,          // TPE_RT_IDX_MCS_1NSS_MM_26_MBPS,
    HAL_PHY_RATE_MCS_1NSS_39_MBPS,          // TPE_RT_IDX_MCS_1NSS_MM_39_MBPS,
    HAL_PHY_RATE_MCS_1NSS_52_MBPS,          // TPE_RT_IDX_MCS_1NSS_MM_52_MBPS,
    HAL_PHY_RATE_MCS_1NSS_58_5_MBPS,        // TPE_RT_IDX_MCS_1NSS_MM_58_5_MBPS,
    HAL_PHY_RATE_MCS_1NSS_65_MBPS,          // TPE_RT_IDX_MCS_1NSS_MM_65_MBPS,
    HAL_PHY_RATE_MCS_1NSS_MM_SG_7_2_MBPS,   // TPE_RT_IDX_MCS_1NSS_MM_SG_7_2_MBPS,
    HAL_PHY_RATE_MCS_1NSS_MM_SG_14_4_MBPS,  // TPE_RT_IDX_MCS_1NSS_MM_SG_14_4_MBPS,
    HAL_PHY_RATE_MCS_1NSS_MM_SG_21_7_MBPS,  // TPE_RT_IDX_MCS_1NSS_MM_SG_21_7_MBPS,
    HAL_PHY_RATE_MCS_1NSS_MM_SG_28_9_MBPS,  // TPE_RT_IDX_MCS_1NSS_MM_SG_28_9_MBPS,
    HAL_PHY_RATE_MCS_1NSS_MM_SG_43_3_MBPS,  // TPE_RT_IDX_MCS_1NSS_MM_SG_43_3_MBPS,
    HAL_PHY_RATE_MCS_1NSS_MM_SG_57_8_MBPS,  // TPE_RT_IDX_MCS_1NSS_MM_SG_57_8_MBPS,
    HAL_PHY_RATE_MCS_1NSS_MM_SG_65_MBPS,    // TPE_RT_IDX_MCS_1NSS_MM_SG_65_MBPS,
    HAL_PHY_RATE_MCS_1NSS_MM_SG_72_2_MBPS,  // TPE_RT_IDX_MCS_1NSS_MM_SG_72_2_MBPS,
    HAL_PHY_RATE_SLR_0_25_MBPS,             // TPE_RT_IDX_SLR_0_25_MBPS = 32,
    HAL_PHY_RATE_SLR_0_5_MBPS,              // TPE_RT_IDX_SLR_0_5_MBPS,
    HAL_PHY_RATE_MCS_1NSS_6_5_MBPS,         // TPE_RT_IDX_MCS_1NSS_GF_6_5_MBPS = 34,
    HAL_PHY_RATE_MCS_1NSS_13_MBPS,          // TPE_RT_IDX_MCS_1NSS_GF_13_MBPS,
    HAL_PHY_RATE_MCS_1NSS_19_5_MBPS,        // TPE_RT_IDX_MCS_1NSS_GF_19_5_MBPS,
    HAL_PHY_RATE_MCS_1NSS_26_MBPS,          // TPE_RT_IDX_MCS_1NSS_GF_26_MBPS,
    HAL_PHY_RATE_MCS_1NSS_39_MBPS,          // TPE_RT_IDX_MCS_1NSS_GF_39_MBPS,
    HAL_PHY_RATE_MCS_1NSS_52_MBPS,          // TPE_RT_IDX_MCS_1NSS_GF_52_MBPS,
    HAL_PHY_RATE_MCS_1NSS_58_5_MBPS,        // TPE_RT_IDX_MCS_1NSS_GF_58_5_MBPS,
    HAL_PHY_RATE_MCS_1NSS_65_MBPS,          // TPE_RT_IDX_MCS_1NSS_GF_65_MBPS,
    HAL_PHY_RATE_INVALID,                   // TPE_RT_IDX_ANI_GF_68_25_MBPS = 42,
    HAL_PHY_RATE_INVALID,                   // TPE_RT_IDX_MCS_1NSS_STBC_GF_6_5_MBPS = TPE_RT_IDX_MAX_TX_RATES,
    HAL_PHY_RATE_INVALID,                   // TPE_RT_IDX_MCS_1NSS_STBC_GF_13_MBPS,
    HAL_PHY_RATE_INVALID,                   // TPE_RT_IDX_MCS_1NSS_STBC_GF_19_5_MBPS,
    HAL_PHY_RATE_INVALID,                   // TPE_RT_IDX_MCS_1NSS_STBC_GF_26_MBPS,
    HAL_PHY_RATE_INVALID,                   // TPE_RT_IDX_MCS_1NSS_STBC_GF_39_MBPS,
    HAL_PHY_RATE_INVALID,                   // TPE_RT_IDX_MCS_1NSS_STBC_GF_52_MBPS,
    HAL_PHY_RATE_INVALID,                   // TPE_RT_IDX_MCS_1NSS_STBC_GF_58_5_MBPS,
    HAL_PHY_RATE_INVALID,                   // TPE_RT_IDX_MCS_1NSS_STBC_GF_65_MBPS,
    HAL_PHY_RATE_INVALID,                   // TPE_RT_IDX_MCS_1NSS_STBC_MM_6_5_MBPS = 51,
    HAL_PHY_RATE_INVALID,                   // TPE_RT_IDX_MCS_1NSS_STBC_MM_SG_7_2_MBPS,
    HAL_PHY_RATE_INVALID,                   // TPE_RT_IDX_MCS_1NSS_STBC_MM_13_MBPS,
    HAL_PHY_RATE_INVALID,                   // TPE_RT_IDX_MCS_1NSS_STBC_MM_SG_14_4_MBPS,
    HAL_PHY_RATE_INVALID,                   // TPE_RT_IDX_MCS_1NSS_STBC_MM_19_5_MBPS,
    HAL_PHY_RATE_INVALID,                   // TPE_RT_IDX_MCS_1NSS_STBC_MM_SG_21_7_MBPS,
    HAL_PHY_RATE_INVALID,                   // TPE_RT_IDX_MCS_1NSS_STBC_MM_26_MBPS,
    HAL_PHY_RATE_INVALID,                   // TPE_RT_IDX_MCS_1NSS_STBC_MM_SG_28_9_MBPS,
    HAL_PHY_RATE_INVALID,                   // TPE_RT_IDX_MCS_1NSS_STBC_MM_39_MBPS,
    HAL_PHY_RATE_INVALID,                   // TPE_RT_IDX_MCS_1NSS_STBC_MM_SG_43_3_MBPS,
    HAL_PHY_RATE_INVALID,                   // TPE_RT_IDX_MCS_1NSS_STBC_MM_52_MBPS,
    HAL_PHY_RATE_INVALID,                   // TPE_RT_IDX_MCS_1NSS_STBC_MM_SG_57_8_MBPS,
    HAL_PHY_RATE_INVALID,                   // TPE_RT_IDX_MCS_1NSS_STBC_MM_58_5_MBPS,
    HAL_PHY_RATE_INVALID,                   // TPE_RT_IDX_MCS_1NSS_STBC_MM_SG_65_MBPS,
    HAL_PHY_RATE_INVALID,                   // TPE_RT_IDX_MCS_1NSS_STBC_MM_65_MBPS,
    HAL_PHY_RATE_INVALID,                   // TPE_RT_IDX_MCS_1NSS_STBC_MM_SG_72_2_MBPS,
    HAL_PHY_RATE_INVALID                    // TPE_RT_IDX_ANI_STBC_GF_68_25_MBPS = 67,
};


/* Funtion to update the Ctrl/Rsp rate's TX power in the local cache 
 * and the TPE MMPI command table if updateTpeHW is set */
void halRate_UpdateCtrlRspTxPower(tpAniSirGlobal pMac, tTpeRateIdx rateIdx,
        tPwrTemplateIndex txPower, tANI_U8 updateTpeHw)
{
    tANI_U32 index;
    tpTpeSramRateTable pTpeRate = NULL;
    tHalRateTable *pHalRate = &halRateTable[0];

    for (index = MIN_LIBRA_RATE_NUM; index < MAX_LIBRA_RATE_NUM; index++) {
        if (rateIdx == pHalRate->tpeRateTable.rspRateIdx) {
            // Check if the txpower is changed from the previous value, if not
            // avoid expensive HW write over the SDIO bus
            if(pHalRate->tpeRateTable.cntrlRspTxPwr != txPower) {
                pHalRate->tpeRateTable.cntrlRspTxPwr = txPower;
                if (updateTpeHw) {
                    pTpeRate = (tpTpeSramRateTable)&halRateTable[index].tpeRateTable;
                    // Update the txpower for the rate index in the TPE rate table
                    halTpe_RateTableWrite(pMac, index, pTpeRate->word0, pTpeRate->word1);
                }
            }
        }
        pHalRate++;
    }

    return;
}

/* Function to get the TX power for the given rate */
void halRate_GetTxPwrForRate(tpAniSirGlobal pMac, tTpeRateIdx rateIdx,
        tANI_S8 regPowerLimit, tPwrTemplateIndex  *pTxPower)
{
    tPowerdBm    phyPowerLimit = 0;
    tPowerdBm    powerLimit = 0;
    eHalPhyRates phyRate;
    tPwrTemplateIndex  power=0;

    phyRate = macPhyRateIndex[rateIdx];

    if (phyRate != HAL_PHY_RATE_INVALID) {
        /* The CFGs WNI_CFG_MAX_TX_POWER_2_4 and WNI_CFG_MAX_TX_POWER_5 are always
         * updated by CSR on STA. If 11D is enabled, the CFG will be updated with
         * country information tuples. By default, the CFGs are updated with EEPROM
         * contents.
         */

        /* EEPROM will have a table for per rate tx power per channel. Something like this:
         * Channel-1
         - Rate-1 - TxPower
         - Rate-2 - TxPower
         - Rate-N - TxPower
         Channel-2
         - Rate-1 - TxPower
         - Rate-2 - TxPower
         - Rate-N - TxPower

         * If 11d is enabled, regulatory max txpower will be the maximum transmit power
         * the system can use for any rate. But since we have internal capping in EEPROM
         * for every rate per channel, we need to take minimum of the two. And that will
         * be the final transmit power the device can use.
         */
        phyPowerLimit = halPhyGetRegDomainLimit(pMac, (eHalPhyRates)phyRate);

        powerLimit = (regPowerLimit <= phyPowerLimit) ? regPowerLimit : phyPowerLimit;

        HALLOG2( halLog(pMac, LOG2, FL("**** Channel-%d, RegPowerLimit-%d, EeProm-%d, Actual-%d, PhyRate-%d ****"),
                    pMac->hal.currentChannel,
                    regPowerLimit,
                    phyPowerLimit,
                    powerLimit,
                    phyRate));

        if (halPhyGetPowerForRate( pMac,
                    phyRate,
                    powerLimit,
                    &power) != eHAL_STATUS_SUCCESS) {
            HALLOGP( halLog(pMac, LOGP, FL("halPhyGetPowerForRate(rateIndex %d) failed \n"), rateIdx));
            return ;

        } else {
            /* For some reason if AP is advertizing wrong local power constraint value
             * which is larger than the power we are operating or larger than regulatory
             * transmit power, then, just use power value returned by PHY
             */
            HALLOG2( halLog(pMac, LOG2, FL("HAL: **** The actual power being set for rateIdx[%d] is - %d ****"), rateIdx, power));

            *pTxPower = power;
        }
    } else {
        HALLOGE( halLog(pMac, LOGE, FL("Invalid phyrate = %d"), phyRate));
    }

    return;
}

/*
 * FUNCTION:  halRate_UpdateRateTablePower
 * NOTE:
 *   Initialize the TPE Command Table, particularly
 *   the transmit power value.
 */
eHalStatus halRate_UpdateRateTablePower(tpAniSirGlobal pMac, tTpeRateIdx startRateIdx, tTpeRateIdx endRateIdx, tANI_U8 updateTpeHw)
{
    tTpeRateIdx index;
    tPowerdBm regPowerLimit;
    tPwrTemplateIndex txPower;

    // Get the regulatory power limit for the given channel and given power constraint
    halUtil_GetRegPowerLimit(pMac, pMac->hal.currentChannel, pMac->hal.gHalLocalPwrConstraint, &regPowerLimit);

    for (index = startRateIdx; index < endRateIdx; index++) {
        // Get the TX power for the given rate
        halRate_GetTxPwrForRate(pMac, index, regPowerLimit, &txPower);

        // Update the TX power for the rate in the local cache,
        // which will be used as a reference to update the tx power in the
        // TPE station descriptor when the rate changes.
        halRate_UpdateRateTxPower(pMac, index, txPower);

        // Update the cntrl/rsp rate tx power locally and in the TPE if the updateTpeHw flag is set.
        halRate_UpdateCtrlRspTxPower(pMac, index, txPower, updateTpeHw);
    }

	// If "updateTpeHw" is TRUE then it implies that Libra is parked at that channel and RA-FW should
	// use the updated TxPower for that channel when selecting the rates, so update the TxPower table
	// in FW.
    if(updateTpeHw) {
        if(endRateIdx >= HAL_MAC_MAX_TX_RATES)
            endRateIdx = HAL_MAC_MAX_TX_RATES;
        halRate_TxPwrIndexToFW(pMac, startRateIdx, endRateIdx);
    }

    return eHAL_STATUS_SUCCESS;
}


/*
 * FUNCTION:  halRate_updateRespRateTable
 *
 * NOTE:
 */
eHalStatus halRate_updateRespRateTable(tpAniSirGlobal pMac, tHalMacRate (*pRefResponseRateTable) [RA_TOTAL_MODULATION][RA_TOTAL_CODERATE])
{
    tANI_U16 tpeRateIdx, halRateIdx, found;
    tANI_S32  mode, codeRate;
    tpHalRateInfo pRate;
    palFillMemory(pMac, &rspRateIndexTable[0], sizeof(rspRateIndexTable), HALRATE_INVALID);

    for ( halRateIdx = HALRATE_MODE_START; halRateIdx < HALRATE_MODE_TX_END ; halRateIdx ++){
        tHalMacRate index = HALRATE_INVALID;
        found = 0;
        pRate = HAL_MACRATE_2_MACRATEINFO(halRateIdx);

        tpeRateIdx = pRate->tpeRateIdx; /* get HAL data rate's corresponding TPE index */
        //HALLOGW( halLog(pMac, LOGW, FL("HAL rate %d, tpeRate %d...\n", halRateIdx, tpeRateIdx)));

        if(tpeRateIdx == TPE_RT_IDX_INVALID)
            continue;

        if(HALRATE_IS_11B(halRateIdx) | HALRATE_IS_SLR(halRateIdx)){
            /* for 11b & SLR rates, use the same rate to respond */
            found = tpeRateIdx;
            rspRateIndexTable[tpeRateIdx]= found;
            //HALLOGW( halLog(pMac, LOGW, FL("11B> Resp H%d. (T%d) => T%d\n"), halRateIdx, tpeRateIdx,  found));
            continue;
        }

        /*otherwise get the modulation type */
        mode = (pRate->rateProperty & RA_MODULATION_MASK);
        if(mode == RA_64QAM)
            mode = RA_16QAM;
        mode>>=RA_MODULATION_SHIFT;

        /* search a valid resp rate within this modulation type */
        for(codeRate = ((pRate->rateProperty & RA_CODERATE_MASK)>>RA_CODERATE_SHIFT); codeRate >= RA_CODERATE_1_2; codeRate --){
            //HALLOGW( halLog( pMac, LOGW, FL("[%d][%d]: %d, thriput: %d, curTHruput:%d\n"), mode,codeRate,(*pRefResponseRateTable)[mode][codeRate], HAL_RA_THRUPUT_GET((*pRefResponseRateTable)[mode][codeRate]),pRate->thruputKbps  ));

//            HALLOGW( halLog( pMac, LOGW, FL("[%d][%d]: %d, thriput: %d, curTHruput:%d\n"),
//                    mode,codeRate,(*pRefResponseRateTable)[mode][codeRate],
//                    HAL_RA_THRUPUT_GET((*pRefResponseRateTable)[mode][codeRate]),
//                    pRate->thruputKbps));

            if((*pRefResponseRateTable)[mode][codeRate] == HALRATE_INVALID){
                continue;
            }
            index = (tHalMacRate)((*pRefResponseRateTable)[mode][codeRate]);

            /*make sure the rate is less than or equal to the rate of received data frame*/
            if( HAL_RA_THRUPUT_GET(index) <= pRate->thruputKbps ){
                /* resp rate selected */
                found  = HAL_RA_TPERATEIDX_GET(index);
                break;
            }
        }

#ifdef RA_CB_ENABLED
        /* if data rate is a 40Mhz rate, use dup mode rate */
        if(found && HALRATE_IS_CB(halRateIdx)){
            tANI_U32 halDupRateIdx;
            halDupRateIdx = HALRATE_CONVERT_BY_TYPE_OFFSET( 11A , DUP_11A , index);

            // if legacy duplicate rates are disabled, use non duplicate rates
            // instead this is only for debugging purpose since some Taurus RF
            // cards have duplicate rate issues.
            if(HALRATE_IS_DISABLED(halDupRateIdx))
                halDupRateIdx = index;
            /* dup mode resp rate selected*/
            found = HAL_RA_TPERATEIDX_GET(halDupRateIdx);
        }
#endif
        rspRateIndexTable[tpeRateIdx]= found;

//        HALLOGW( halLog(pMac, LOGW, FL("Resp H%d. (S%d) modulation %d code %d => S%d\n"),
//                halRateIdx, tpeRateIdx, mode, codeRate, found));

    }
    return eHAL_STATUS_SUCCESS;
}


eHalStatus halRate_updateResponseRateTable(tpAniSirGlobal pMac){
    return halRate_updateRespRateTable(pMac, &currentRefRespRateTable );
}

/*
 * Function to update the basic rate set reference table.
 * This table would be later used to auto generate
 * response rate table and send to TPE
 */
tANI_U32 _updateBasicRateSet(tpAniSirGlobal pMac, tANI_U16 ieRate)
{
    tHalMacRate defRefRespRateTable [RA_TOTAL_MODULATION][RA_TOTAL_CODERATE] ={
        /*              1/2                 2/3            3/4         4/5              5/6  */
        /* BPSK  */ {HALRATE_6,       HALRATE_INVALID, HALRATE_9,  HALRATE_INVALID, HALRATE_INVALID },
        /* QPSK  */ {HALRATE_12,      HALRATE_INVALID, HALRATE_18, HALRATE_INVALID, HALRATE_INVALID },
        /* 16QAM */ {HALRATE_24,      HALRATE_INVALID, HALRATE_36, HALRATE_INVALID, HALRATE_INVALID },
        /* 64QAM */ {HALRATE_INVALID, HALRATE_48,      HALRATE_54, HALRATE_INVALID, HALRATE_INVALID }
    };

    tHalMacRate halRate;

    if( (halConvertIeToMacRate(pMac, ieRate, &halRate)==eSIR_SUCCESS) &&  (HALRATE_IS_11AG(halRate))){
        tANI_U32 modulation, coding;
        for(modulation=0; modulation < RA_TOTAL_MODULATION; modulation++){
            for(coding=0; coding < RA_TOTAL_CODERATE; coding++){
                tpHalRateInfo pRate = HAL_MACRATE_2_MACRATEINFO(defRefRespRateTable[modulation][coding]);
                if(( ieRate & IERATE_RATE_MASK) == pRate->ieRateMcsIdx ){
                    if(IERATE_IS_BASICRATE(ieRate)){
                        currentRefRespRateTable[modulation][coding] = defRefRespRateTable[modulation][coding];
                        currentRefBasicRateTable[modulation][coding]= defRefRespRateTable[modulation][coding];
                        return 1;
                    }else{
                        if (coding!=0) {
                            currentRefRespRateTable[modulation][coding] = HALRATE_INVALID;
                        }
                        currentRefBasicRateTable[modulation][coding]= HALRATE_INVALID;
                    }
                    break;
                }
            }
        }
    }
    return 0;
}

/*
 * per BSS response rate table is not supported,
 * here we just update the global response rate table
 */
eHalStatus halRate_updateResponseRateTableByBssBasicRate(tpAniSirGlobal pMac,
        tpSirSupportedRates pSuppRates)
{
    tANI_U32 ieRate;

    /* for 11b rates, response rate = data rate */
    /* for 11a/g rates, set basic rates */

    /* update the basic rate set */
    for( ieRate=0; ieRate< SIR_NUM_11A_RATES; ieRate++){
        _updateBasicRateSet(pMac, pSuppRates->llaRates[ieRate]);
    }

    /* update the response rate table for all rates supported based on modulation/coding rate*/
    if (halRate_updateRespRateTable(pMac, &currentRefRespRateTable) != eHAL_STATUS_SUCCESS) {
        HALLOGE( halLog(pMac, LOGE, FL("halRate_updateRespRateTable() failed \n")));
        return eHAL_STATUS_FAILURE;
    }

    /* send new response rate table to TPE */
    halRate_sendResponseRateTable(pMac);

    return eHAL_STATUS_SUCCESS;
}

// Function to update the response rate indices in the TPE rate table
eHalStatus halRate_sendResponseRateTable(tpAniSirGlobal pMac)
{
    tANI_U16 i;
    eHalStatus status = eHAL_STATUS_FAILURE;
    tpTpeSramRateTable pTpeRateTableEntry;

    HALLOGW(halLog(pMac, LOGW, FL("MAX_LIBRA_RATE_NUM %d"), MAX_LIBRA_TX_RATE_NUM));

    for (i = 0; i < MAX_LIBRA_RATE_NUM; i++) {
        halRateTable[i].tpeRateTable.rspRateIdx = rspRateIndexTable[i];
        halRateTable[i].tpeRateTable.cntrlRateIdx = rspRateIndexTable[i];
        pTpeRateTableEntry = (tpTpeSramRateTable)&halRateTable[i].tpeRateTable;

        if ((status = halTpe_RateTableWrite(pMac, i, pTpeRateTableEntry->word0,
                        pTpeRateTableEntry->word1)) != eHAL_STATUS_SUCCESS) {
            return status;
        }
    }

    return status;
}

/*
 * To enable/disable specific TPE rate index in RA module.
 */
eHalStatus halRate_enableTpeRate(tpAniSirGlobal hHal, tANI_U32 enable, tANI_U32 tpeRateIdx)
{
    tHalMacRate halRate = (tHalMacRate)halRate_tpeRate2HalRate(tpeRateIdx);

    if(halRate != HALRATE_INVALID){
        tpHalRateInfo pHalRate =  HAL_MACRATE_2_MACRATEINFO(halRate);
        if(enable) {
            pHalRate->rateProperty &= ~ RA_DISABLED;
        } else {
            pHalRate->rateProperty |= RA_DISABLED;
        }
        /* this is inefficient when the caller calls this function in a loop
        halRate_halRateInfoTableToFW(hHal, tpeRateIdx, tpeRateIdx+1);
        */
        return eHAL_STATUS_SUCCESS;
    }
    return eHAL_STATUS_FAILURE;
}


/* Function to compute the bytes in the space between MPDUs in AMPDU*/
tANI_U32 halRate_GetMpduSpaceByTpeRate(
    tANI_U32 halRateIdx,
    tANI_U32 minimumMdpuStartSpacingParam)
{
    tTpeRateTable *pTpeRateEntry;
    tANI_U32 dbps;
    tANI_U32 quarterUs;
    tANI_U32 dataRate; /* bit per us */
    tANI_U32 mpduSpace;
    tTpeRateIdx tpeRateIndex;
    tpHalRateInfo pRateInfo;

    tpeRateIndex = halRate_halRate2TpeRate(halRateIdx);

    /* Check the validity of TPE rate index */
    if (tpeRateIndex == TPE_RT_IDX_INVALID)
        return 0;

    pRateInfo = HAL_MACRATE_2_MACRATEINFO(halRateIdx);

    /* Get the pointer to rate table entry */
    pTpeRateEntry = (tTpeRateTable *)&tpeSramRateTable[tpeRateIndex];

    /* N_DBPS */
    dbps = pTpeRateEntry->ndbpsOr4timesRate;

    switch (pTpeRateEntry->pktType) {
    case PKT_TYPE_11N_GREENFIELD :
    case PKT_TYPE_11N_MIXEDMODE :
        if (minimumMdpuStartSpacingParam == 0)
            return 0;

        /* Get the phy data rate for the given rate index */
        dataRate = (pRateInfo->thruputKbps + 9)/ 10;

        /* number of quater microseconds */
        quarterUs = 1 << (minimumMdpuStartSpacingParam - 1);

        /* MPDU space (bit) = data rate * time
                            = (data rate * quarter microseconds) / 4
         */
        mpduSpace = (dataRate * quarterUs + 3) / 4;
        mpduSpace = (mpduSpace + 7) / 8;

        /* Example 1.
             Data rate = 600 Mbps (NDBPS = 2160, dataRate = (2160 * 5 + 17) / 18 = 600.9 = 600 bit per us)
             minimumMdpuStartSpacingParam = 3 (1 us)
             quarterUs = 1 << (3 - 1) = 1 << 2 = 4
             mpduSpaceBit = (600 * 4 + 3) / 4 = 600 bit
             mpduSpaceByte = (600 + 7) / 8 = 75 bytes

           Example 2.
             Data rate = 540 Mbps (NDBPS = 2160, dataRate = (2160 / 4) = 540 bit per us)
             minimumMdpuStartSpacingParam = 2 (0.5 us)
             quarterUs = 1 << (2 - 1) = 1 << 1 = 2
             mpduSpaceBit = (540 * 2 + 3) / 4 = 270 bit
             mpduSpaceByte = (270 + 7) / 8 = 34 bytes
        */
        return mpduSpace;

    default :
        return 0;
    }
}

/*
 * To change max actual TCP/IP throughput for a  specific TPE rate index in RA module.
 */
eHalStatus halRate_changeTpeRateMaxActualTput(tpAniSirGlobal hHal,
        tANI_U32 maxTput, tANI_U32 tpeRateIdx)
{
    tHalMacRate halRate = (tHalMacRate)halRate_tpeRate2HalRate(tpeRateIdx);

    if(halRate != HALRATE_INVALID){
        tpHalRateInfo pHalRate =  HAL_MACRATE_2_MACRATEINFO(halRate);
        HALLOGE( halLog(hHal, LOGE, FL("MaxTput for Rate %d changed from %d to %d\n"),
                pHalRate->actualTputKbps, maxTput));

        pHalRate->actualTputKbps = (tANI_U16)maxTput;
        return eHAL_STATUS_SUCCESS;
    }

    return eHAL_STATUS_FAILURE;
}

/* ------------------------------------------
 * FUNCTION:  halRateDbg_overrideStaRateProtPolicy()
 *
 * NOTE:
 *   For a given staid and chnl, change protection
 *   policy for primary, secondary and tertiary rates.
 * ------------------------------------------ */
void  halRateDbg_overrideStaRateProtPolicy(tpAniSirGlobal pMac,
        tANI_U32 chnl, tANI_U32 staid,  tANI_S32 priProtMode,
        tANI_S32 secProtMode,  tANI_S32 triProtMode,
        tANI_S32 priProtRate, tANI_S32 secProtRate, tANI_S32 terProtRate)
{
 #if 0
    tpStaStruct t = (tpStaStruct) pMac->hal.halMac.staTable;
    tTpeStaDescRateInfo *pRateInfo;
    tHalCfgSta *pStaParam = &t[staid].staParam;

    //change Primary rate
    pRateInfo = &pStaParam->rateInfo[HAL_RA_TXRATE_NORMAL][chnl];
    if(priProtRate!=HAL_PROTINFO_NOCHG)
        pRateInfo->protectionRateIdx = (tANI_U32)halRate_halRate2TpeRate((tHalMacRate)priProtRate);
    if(priProtMode!=HAL_PROTINFO_NOCHG)
        pRateInfo->protectionPolicy = priProtMode;

    //change secondary rate
    pRateInfo = &pStaParam->rateInfo[HAL_RA_TXRATE_RETRY1][chnl];
    if(secProtRate!=HAL_PROTINFO_NOCHG)
        pRateInfo->protectionRateIdx = (tANI_U32)halRate_halRate2TpeRate((tHalMacRate)secProtRate);
    if(secProtMode!=HAL_PROTINFO_NOCHG)
        pRateInfo->protectionPolicy = secProtMode;

    //change tertiary rate
    pRateInfo = &pStaParam->rateInfo[HAL_RA_TXRATE_RETRY2][chnl];

    if(terProtRate!=HAL_PROTINFO_NOCHG)
        pRateInfo->protectionRateIdx = (tANI_U32)halRate_halRate2TpeRate((tHalMacRate)terProtRate);
    if(triProtMode!=HAL_PROTINFO_NOCHG)
        pRateInfo->protectionPolicy = triProtMode;
#endif
}


/*
 * DESCRIPTION:
 *      Routine to write TPE Rate Table into the ADU memory.
 *      The contents of the rate table are written into the
 *      hardware through indirectly addressed registers.
 *      Basically by writting the value of the table entry
 *      into the data register and then writing into command
 *      the  command register. So the this table contains
 *      a repetition of the value in the data and command
 *      registers
 *
 * PARAMETERS:
 *      pMac:   Pointer to the global adapter context
 *      pAddr:  Starting address in the ADU memory from where the
 *              register/value tuple will be written
 *
 * RETURN:
 *      eHAL_STATUS_SUCCESS
 *      eHAL_STATUS_FAILURE
 */
eHalStatus halRate_BckupTpeRateTable(tpAniSirGlobal pMac, tANI_U32 *pAddr)
{
    tpTpeSramRateTable pTpeRateTableEntry;
    tANI_U32 value, i;
    tANI_U32 startAddr = *pAddr;
    tANI_U32 *pMemAddr = (tANI_U32*)startAddr;

    tHalRateTable *pRateTable = &halRateTable[0];

    for (i = 0; i < MAX_LIBRA_RATE_NUM; i++) {
        pTpeRateTableEntry = (tpTpeSramRateTable)&pRateTable[i].tpeRateTable;

        value = QWLAN_TPE_RATE_TABLE_SRAM_DATA0_REG | HAL_REG_RSVD_BIT | HAL_REG_HOST_FILLED;
        // Write data0 register address and value
        halWriteDeviceMemory(pMac, (tANI_U32)pMemAddr++,
                    (tANI_U8*)&value, sizeof(tANI_U32));

        halWriteDeviceMemory(pMac, (tANI_U32)pMemAddr++,
                    (tANI_U8*)&pTpeRateTableEntry->word0, sizeof(tANI_U32)) ;


        // Write data1 register address and value
        value = QWLAN_TPE_RATE_TABLE_SRAM_DATA1_REG | HAL_REG_RSVD_BIT | HAL_REG_HOST_FILLED;
        halWriteDeviceMemory(pMac, (tANI_U32)pMemAddr++,
                    (tANI_U8*)&value, sizeof(tANI_U32));

        halWriteDeviceMemory(pMac, (tANI_U32)pMemAddr++,
                    (tANI_U8*)&pTpeRateTableEntry->word1, sizeof(tANI_U32));

        // Write address of control register and value
        value = QWLAN_TPE_RATE_TABLE_SRAM_CONTROL_REG | HAL_REG_RSVD_BIT | HAL_REG_HOST_FILLED;
        halWriteDeviceMemory(pMac, (tANI_U32)pMemAddr++,
                    (tANI_U8*)&value, sizeof(tANI_U32));

        /* Start the Write transaction by writing 0 to bit 31 */
        value = ((i << QWLAN_TPE_RATE_TABLE_SRAM_CONTROL_RATE_SRAM_XACT_ADDR_OFFSET) |
                QWLAN_TPE_RATE_TABLE_SRAM_CONTROL_RATE_SRAM_XACT_START_MASK |
                QWLAN_TPE_RATE_TABLE_SRAM_CONTROL_RATE_SRAM_XACT_WRITE_READZ_MASK) &
            ~QWLAN_TPE_RATE_TABLE_SRAM_CONTROL_RATE_SRAM_XACT_DONE_MASK;

        halWriteDeviceMemory(pMac, (tANI_U32)pMemAddr++,
                    (tANI_U8*)&value, sizeof(tANI_U32));

    }

    // Update the start address pointer pointing to the
    // register re-init table
    *pAddr = (tANI_U32)pMemAddr;

    return eHAL_STATUS_SUCCESS;
}

